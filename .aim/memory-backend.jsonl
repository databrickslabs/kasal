{"type":"_aim","source":"mcp-knowledge-graph"}
{"type":"entity","name":"ProcessCrewExecutor","entityType":"service","observations":["Handles crew execution workflow","Process management for AI agents","Located in src/backend/src/services/process_crew_executor.py","Recently modified - likely core to execution flow"]}
{"type":"entity","name":"CrewAIEngineService","entityType":"service","observations":["CrewAI integration and orchestration","Located in src/backend/src/engines/crewai/crewai_engine_service.py","Engine service for CrewAI framework","Recently modified - active development"]}
{"type":"entity","name":"TemplateService","entityType":"service","observations":["Template management for workflows","Located in src/backend/src/services/template_service.py","Handles workflow templates","Recently modified"]}
{"type":"entity","name":"DatabricksKnowledgeService","entityType":"service","observations":["Databricks integration for knowledge management","Located in src/backend/src/services/databricks_knowledge_service.py","Vector search and knowledge storage","Recently modified"]}
{"type":"entity","name":"CrewPreparation","entityType":"helper","observations":["Crew setup and preparation logic","Located in src/backend/src/engines/crewai/crew_preparation.py","Handles crew initialization","Recently modified","Initializes ToolFactory with config and user_token","Passes ToolFactory to _create_agents() and _create_tasks()","ToolFactory instance stored as self.tool_factory","Provides ToolFactory to agent_helpers.create_agent()","Provides ToolFactory to task_helpers.create_task()"]}
{"type":"entity","name":"AgentHelpers","entityType":"helper","observations":["Agent utility functions and helpers","Located in src/backend/src/engines/crewai/helpers/agent_helpers.py","Agent configuration and setup","Recently modified"]}
{"type":"entity","name":"DatabricksEmbedder","entityType":"knowledge_component","observations":["Text embedding service using Databricks","Located in src/backend/src/engines/crewai/knowledge/databricks_embedder.py","New file - vector embedding functionality","Converts text to vectors for similarity search"]}
{"type":"entity","name":"AuthRouter","entityType":"api_router","observations":["Authentication endpoints","Login/logout/refresh token routes","Databricks OAuth integration","JWT token management","Located in /auth routes"]}
{"type":"entity","name":"CrewRouter","entityType":"api_router","observations":["Crew management endpoints","Create/update/delete crew workflows","Execute crew processes","Get crew status and results","Located in /crews routes"]}
{"type":"entity","name":"AgentRouter","entityType":"api_router","observations":["Agent configuration endpoints","CRUD operations for agents","Agent parameter management","Agent validation","Located in /agents routes"]}
{"type":"entity","name":"KnowledgeRouter","entityType":"api_router","observations":["Knowledge source management","File upload and processing","Vector search operations","Databricks volume integration","Located in /knowledge routes"]}
{"type":"entity","name":"TemplateRouter","entityType":"api_router","observations":["Template management endpoints","CRUD operations for workflow templates","Template validation and parsing","Template sharing and export","Located in /templates routes"]}
{"type":"entity","name":"ModelRouter","entityType":"api_router","observations":["LLM model configuration endpoints","Model provider management","Model parameter tuning","Model validation and testing","Located in /models routes"]}
{"type":"entity","name":"ProcessRouter","entityType":"api_router","observations":["Process execution endpoints","Start/stop/pause process operations","Process monitoring and logging","Real-time status updates","Located in /processes routes"]}
{"type":"entity","name":"WebSocketManager","entityType":"websocket_handler","observations":["Real-time communication with frontend","Process execution status updates","Live logging and progress streams","Agent output broadcasting","WebSocket connection management"]}
{"type":"entity","name":"UserModel","entityType":"database_model","observations":["User account and profile data","Authentication credentials","User preferences and settings","Databricks workspace association","SQLAlchemy ORM model"]}
{"type":"entity","name":"CrewModel","entityType":"database_model","observations":["Crew workflow definitions","Agent configurations and relationships","Execution parameters","Created/modified timestamps","User ownership and permissions"]}
{"type":"entity","name":"AgentModel","entityType":"database_model","observations":["Agent configuration and parameters","Role definitions and instructions","Tool assignments","Model provider settings","Performance metrics"]}
{"type":"entity","name":"ProcessModel","entityType":"database_model","observations":["Process execution records","Status tracking (pending/running/completed/failed)","Start/end timestamps","Input parameters and outputs","Error logs and debugging info"]}
{"type":"entity","name":"KnowledgeSourceModel","entityType":"database_model","observations":["Knowledge source configurations","Databricks volume/vector search settings","File metadata and indexing","Access permissions","Embedding configurations"]}
{"type":"entity","name":"TemplateModel","entityType":"database_model","observations":["Workflow template definitions","Template metadata and tags","Version control and history","Usage statistics","Sharing and visibility settings"]}
{"type":"entity","name":"UserRepository","entityType":"repository","observations":["User data access layer","Authentication and authorization queries","User preference management","Async database operations","Unit of Work pattern implementation"]}
{"type":"entity","name":"CrewRepository","entityType":"repository","observations":["Crew workflow data access","CRUD operations for crews","User-specific crew filtering","Execution history queries","Relationship management with agents"]}
{"type":"entity","name":"AgentRepository","entityType":"repository","observations":["Agent configuration data access","Agent performance tracking","Tool assignment management","Model configuration queries","Agent validation and testing"]}
{"type":"entity","name":"ProcessRepository","entityType":"repository","observations":["Process execution data access","Status update operations","Log storage and retrieval","Performance metrics collection","Error tracking and analysis"]}
{"type":"entity","name":"KnowledgeRepository","entityType":"repository","observations":["Knowledge source data access","File metadata operations","Vector search integration","Databricks volume management","Embedding storage and retrieval"]}
{"type":"entity","name":"TemplateRepository","entityType":"repository","observations":["Template data access layer","Version control operations","Template sharing management","Usage analytics","Template validation and parsing"]}
{"type":"entity","name":"AuthUtilities","entityType":"utility","observations":["JWT token generation and validation","Password hashing and verification","OAuth flow management","Session management","Security middleware functions"]}
{"type":"entity","name":"ValidationUtilities","entityType":"utility","observations":["Input data validation","Schema validation for API requests","Business rule validation","Data sanitization","Error formatting and handling"]}
{"type":"entity","name":"LoggingUtilities","entityType":"utility","observations":["Structured logging configuration","Log formatting and filtering","Performance monitoring","Error tracking integration","Audit trail management"]}
{"type":"entity","name":"DatabaseUtilities","entityType":"utility","observations":["Connection pool management","Transaction handling","Migration utilities","Backup and restore functions","Query optimization helpers"]}
{"type":"entity","name":"FlowModel","entityType":"database_model","observations":["Workflow/Flow definitions","Located in src/backend/src/models/flow.py","Core business entity for AI workflows","Contains flow metadata and configuration","Relationships to agents, tasks, and executions"]}
{"type":"entity","name":"FlowExecutionModel","entityType":"database_model","observations":["Flow execution instances","Located in src/backend/src/models/flow_execution.py","Tracks individual flow runs","Execution status and timing","Links to execution logs and traces"]}
{"type":"entity","name":"TaskModel","entityType":"database_model","observations":["Individual task definitions within flows","Located in src/backend/src/models/task.py","Task configuration and parameters","Relationships to agents and tools","Task execution tracking"]}
{"type":"entity","name":"CrewModel_Real","entityType":"database_model","observations":["Real crew model implementation","Located in src/backend/src/models/crew.py","Agent group orchestration","Crew configuration and settings","Links to agents and execution history"]}
{"type":"entity","name":"AgentModel_Real","entityType":"database_model","observations":["Real agent model implementation","Located in src/backend/src/models/agent.py","Agent configuration and behavior","Role definitions and instructions","Tool assignments and capabilities"]}
{"type":"entity","name":"ToolModel","entityType":"database_model","observations":["Tool definitions and configurations","Located in src/backend/src/models/tool.py","Tool metadata and parameters","API integrations and credentials","Tool usage tracking and analytics"]}
{"type":"entity","name":"TemplateModel_Real","entityType":"database_model","observations":["Real template model implementation","Located in src/backend/src/models/template.py","Workflow template definitions","Template versioning and metadata","Usage statistics and sharing settings"]}
{"type":"entity","name":"UserModel_Real","entityType":"database_model","observations":["Real user model implementation","Located in src/backend/src/models/user.py","User authentication and profile","Workspace associations","User preferences and settings"]}
{"type":"entity","name":"ExecutionStatusModel","entityType":"database_model","observations":["Execution status tracking","Located in src/backend/src/models/execution_status.py","Status enums and state management","Execution phase tracking","Status transition logging"]}
{"type":"entity","name":"ExecutionLogsModel","entityType":"database_model","observations":["Detailed execution logging","Located in src/backend/src/models/execution_logs.py","Log entries for executions","Error tracking and debugging","Performance metrics collection"]}
{"type":"entity","name":"ExecutionTraceModel","entityType":"database_model","observations":["Execution trace and debugging","Located in src/backend/src/models/execution_trace.py","Step-by-step execution tracking","Agent decision traces","Debug information and call stacks"]}
{"type":"entity","name":"ExecutionHistoryModel","entityType":"database_model","observations":["Historical execution records","Located in src/backend/src/models/execution_history.py","Long-term execution analytics","Performance trends","Historical comparisons and insights"]}
{"type":"entity","name":"GroupModel","entityType":"database_model","observations":["User group and organization management","Located in src/backend/src/models/group.py","Multi-tenancy support","Group permissions and access control","Resource sharing and isolation"]}
{"type":"entity","name":"BillingModel","entityType":"database_model","observations":["Billing and usage tracking","Located in src/backend/src/models/billing.py","Cost tracking per execution","Resource usage metrics","Billing integration and reporting"]}
{"type":"entity","name":"LogModel","entityType":"database_model","observations":["General application logging","Located in src/backend/src/models/log.py","System logs and events","Audit trail and compliance","Application monitoring"]}
{"type":"entity","name":"ChatHistoryModel","entityType":"database_model","observations":["Chat and conversation history","Located in src/backend/src/models/chat_history.py","User interaction logs","Conversation context storage","Chat analytics and insights"]}
{"type":"entity","name":"ModelConfigModel","entityType":"database_model","observations":["LLM model configurations","Located in src/backend/src/models/model_config.py","Model provider settings","Parameter tuning and optimization","Cost and performance configurations"]}
{"type":"entity","name":"EngineConfigModel","entityType":"database_model","observations":["Engine configuration settings","Located in src/backend/src/models/engine_config.py","Execution engine parameters","Runtime configurations","Performance tuning settings"]}
{"type":"entity","name":"DatabricksConfigModel","entityType":"database_model","observations":["Databricks integration settings","Located in src/backend/src/models/databricks_config.py","Workspace and cluster configurations","Authentication and access tokens","Volume and catalog settings"]}
{"type":"entity","name":"ApiKeyModel","entityType":"database_model","observations":["API key management","Located in src/backend/src/models/api_key.py","External service API keys","Key rotation and security","Service integration credentials"]}
{"type":"entity","name":"ScheduleModel","entityType":"database_model","observations":["Workflow scheduling and automation","Located in src/backend/src/models/schedule.py","Cron-like scheduling definitions","Recurring execution patterns","Schedule management and triggers"]}
{"type":"entity","name":"DataProcessingModel","entityType":"database_model","observations":["Data processing pipeline configurations","Located in src/backend/src/models/data_processing.py","Data transformation rules","Processing pipeline definitions","Input/output data mappings"]}
{"type":"entity","name":"DocumentationEmbeddingModel","entityType":"database_model","observations":["Documentation vector embeddings","Located in src/backend/src/models/documentation_embedding.py","Knowledge base embeddings","Document indexing and search","Semantic search capabilities"]}
{"type":"entity","name":"MemoryBackendModel","entityType":"database_model","observations":["Memory backend configurations","Located in src/backend/src/models/memory_backend.py","Agent memory persistence","Memory storage backends","Context and history management","Stores memory CONFIGURATION only, not actual memory content","Configuration includes memory type, settings, and metadata","Actual memory content stored separately in Databricks Vector Search","Database acts as configuration registry for memory backends","Vector Search handles the actual memory storage and retrieval","Frontend warning: 'Requires memory backend configuration' displayed in DatabricksConfiguration.tsx","Warning condition: isMemoryBackendConfigured is false","Check logic: backend_type must be DATABRICKS AND endpoint_name AND short_term_index must be present","Knowledge sources ONLY work with Databricks Vector Search, not with ChromaDB","Frontend checks configuration via MemoryBackendService.getConfig() API call"]}
{"type":"entity","name":"McpSettingsModel","entityType":"database_model","observations":["MCP server settings and configurations","Located in src/backend/src/models/mcp_settings.py","Model Context Protocol configurations","Server connection parameters","MCP integration settings"]}
{"type":"entity","name":"McpServerModel","entityType":"database_model","observations":["MCP server definitions","Located in src/backend/src/models/mcp_server.py","Available MCP servers","Server capabilities and endpoints","Connection status and health"]}
{"type":"entity","name":"PrivilegesModel","entityType":"database_model","observations":["User privileges and permissions","Located in src/backend/src/models/privileges.py","Role-based access control","Permission matrices","Security and authorization settings"]}
{"type":"entity","name":"InitializationStatusModel","entityType":"database_model","observations":["System initialization tracking","Located in src/backend/src/models/initialization_status.py","Startup sequence monitoring","Component initialization status","System health and readiness checks"]}
{"type":"entity","name":"SchemaModel","entityType":"database_model","observations":["Database schema versioning","Located in src/backend/src/models/schema.py","Schema evolution tracking","Migration status","Database structure metadata"]}
{"type":"entity","name":"EnumsModel","entityType":"database_model","observations":["Enum definitions and constants","Located in src/backend/src/models/enums.py","Status enumerations","Type definitions","Shared constants across models"]}
{"type":"entity","name":"FlowRepository_Real","entityType":"repository","observations":["Real flow repository implementation","Located in src/backend/src/repositories/flow_repository.py","Flow CRUD operations","Flow query and filtering","Flow relationship management"]}
{"type":"entity","name":"FlowExecutionRepository_Real","entityType":"repository","observations":["Real flow execution repository","Located in src/backend/src/repositories/flow_execution_repository.py","Execution tracking and monitoring","Status updates and progress","Execution history management"]}
{"type":"entity","name":"TaskRepository_Real","entityType":"repository","observations":["Real task repository implementation","Located in src/backend/src/repositories/task_repository.py","Task CRUD operations","Task dependency management","Task execution tracking"]}
{"type":"entity","name":"CrewRepository_Real","entityType":"repository","observations":["Real crew repository implementation","Located in src/backend/src/repositories/crew_repository.py","Crew management operations","Agent orchestration queries","Crew execution history"]}
{"type":"entity","name":"AgentRepository_Real","entityType":"repository","observations":["Real agent repository implementation","Located in src/backend/src/repositories/agent_repository.py","Agent CRUD operations","Agent configuration management","Agent performance analytics"]}
{"type":"entity","name":"ToolRepository_Real","entityType":"repository","observations":["Real tool repository implementation","Located in src/backend/src/repositories/tool_repository.py","Tool management and configuration","Tool usage tracking","Tool integration metadata"]}
{"type":"entity","name":"TemplateRepository_Real","entityType":"repository","observations":["Real template repository implementation","Located in src/backend/src/repositories/template_repository.py","Template CRUD operations","Template versioning","Template sharing and permissions"]}
{"type":"entity","name":"UserRepository_Real","entityType":"repository","observations":["Real user repository implementation","Located in src/backend/src/repositories/user_repository.py","User authentication and profile","User preference management","Workspace association queries"]}
{"type":"entity","name":"ExecutionRepository","entityType":"repository","observations":["Execution management repository","Located in src/backend/src/repositories/execution_repository.py","General execution operations","Execution state management","Cross-execution analytics","Fixed group filtering vulnerability where empty group_ids list returned all executions","Now properly returns zero results when group_ids is empty list","Ensures strict group isolation for multi-tenant security"]}
{"type":"entity","name":"ExecutionLogsRepository","entityType":"repository","observations":["Execution logs repository","Located in src/backend/src/repositories/execution_logs_repository.py","Log storage and retrieval","Log filtering and search","Performance log analysis"]}
{"type":"entity","name":"ExecutionTraceRepository","entityType":"repository","observations":["Execution trace repository","Located in src/backend/src/repositories/execution_trace_repository.py","Trace data management","Debug information storage","Step-by-step execution tracking"]}
{"type":"entity","name":"ExecutionHistoryRepository","entityType":"repository","observations":["Execution history repository","Located in src/backend/src/repositories/execution_history_repository.py","Historical execution data","Analytics and reporting","Performance trend analysis"]}
{"type":"entity","name":"GroupRepository","entityType":"repository","observations":["Group management repository","Located in src/backend/src/repositories/group_repository.py","Multi-tenant group operations","Group permission management","Resource sharing queries"]}
{"type":"entity","name":"BillingRepository","entityType":"repository","observations":["Billing and usage repository","Located in src/backend/src/repositories/billing_repository.py","Cost tracking operations","Usage metrics collection","Billing report generation"]}
{"type":"entity","name":"LogRepository","entityType":"repository","observations":["Application log repository","Located in src/backend/src/repositories/log_repository.py","System log management","Audit trail operations","Log aggregation and analysis"]}
{"type":"entity","name":"ChatHistoryRepository","entityType":"repository","observations":["Chat history repository","Located in src/backend/src/repositories/chat_history_repository.py","Conversation storage","Chat analytics","Context retrieval operations"]}
{"type":"entity","name":"ModelConfigRepository","entityType":"repository","observations":["Model configuration repository","Located in src/backend/src/repositories/model_config_repository.py","LLM model settings management","Model parameter optimization","Provider configuration operations"]}
{"type":"entity","name":"EngineConfigRepository","entityType":"repository","observations":["Engine configuration repository","Located in src/backend/src/repositories/engine_config_repository.py","Engine parameter management","Runtime configuration operations","Performance tuning queries"]}
{"type":"entity","name":"DatabricksConfigRepository","entityType":"repository","observations":["Databricks configuration repository","Located in src/backend/src/repositories/databricks_config_repository.py","Databricks integration settings","Workspace configuration management","Authentication token operations"]}
{"type":"entity","name":"ApiKeyRepository","entityType":"repository","observations":["API key management repository","Located in src/backend/src/repositories/api_key_repository.py","API key CRUD operations","Key rotation and security","Service credential management"]}
{"type":"entity","name":"ScheduleRepository","entityType":"repository","observations":["Schedule management repository","Located in src/backend/src/repositories/schedule_repository.py","Workflow scheduling operations","Cron job management","Schedule trigger operations"]}
{"type":"entity","name":"DataProcessingRepository","entityType":"repository","observations":["Data processing repository","Located in src/backend/src/repositories/data_processing_repository.py","Data pipeline management","Processing rule operations","Data transformation tracking"]}
{"type":"entity","name":"DocumentationEmbeddingRepository","entityType":"repository","observations":["Documentation embedding repository","Located in src/backend/src/repositories/documentation_embedding_repository.py","Vector embedding operations","Knowledge base search","Semantic similarity queries"]}
{"type":"entity","name":"MemoryBackendRepository","entityType":"repository","observations":["Memory backend repository","Located in src/backend/src/repositories/memory_backend_repository.py","Agent memory persistence","Context storage operations","Memory retrieval and management"]}
{"type":"entity","name":"McpRepository","entityType":"repository","observations":["MCP (Model Context Protocol) repository","Located in src/backend/src/repositories/mcp_repository.py","MCP server management","Protocol configuration operations","Server health monitoring"]}
{"type":"entity","name":"SchemaRepository","entityType":"repository","observations":["Database schema repository","Located in src/backend/src/repositories/schema_repository.py","Schema version management","Migration tracking","Database structure operations"]}
{"type":"entity","name":"TaskTrackingRepository","entityType":"repository","observations":["Task tracking repository","Located in src/backend/src/repositories/task_tracking_repository.py","Task progress monitoring","Dependency tracking","Task analytics operations"]}
{"type":"entity","name":"AgentTraceRepository","entityType":"repository","observations":["Agent trace repository","Located in src/backend/src/repositories/agent_trace_repository.py","Agent decision tracking","Behavior analysis","Agent performance monitoring"]}
{"type":"entity","name":"OutputCombinerRepository","entityType":"repository","observations":["Output combiner repository","Located in src/backend/src/repositories/output_combiner_repository.py","Output aggregation operations","Result combination logic","Multi-agent output merging"]}
{"type":"entity","name":"CrewGeneratorRepository","entityType":"repository","observations":["Crew generator repository","Located in src/backend/src/repositories/crew_generator_repository.py","Dynamic crew creation","Template-based crew generation","Crew optimization operations"]}
{"type":"entity","name":"GenieRepository","entityType":"repository","observations":["Genie repository","Located in src/backend/src/repositories/genie_repository.py","AI assistant functionality","Smart recommendations","Automated workflow suggestions"]}
{"type":"entity","name":"DatabaseBackupRepository","entityType":"repository","observations":["Database backup repository","Located in src/backend/src/repositories/database_backup_repository.py","Database backup operations","Restore functionality","Data integrity management"]}
{"type":"entity","name":"DatabricksVectorIndexRepository","entityType":"repository","observations":["Databricks vector index repository","Located in src/backend/src/repositories/databricks_vector_index_repository.py","Vector index management","Databricks Vector Search operations","Index optimization and maintenance"]}
{"type":"entity","name":"DatabricksVectorEndpointRepository","entityType":"repository","observations":["Databricks vector endpoint repository","Located in src/backend/src/repositories/databricks_vector_endpoint_repository.py","Vector endpoint configuration","Search endpoint management","Performance monitoring"]}
{"type":"entity","name":"DatabricksVolumeRepository","entityType":"repository","observations":["Databricks volume repository","Located in src/backend/src/repositories/databricks_volume_repository.py","Volume storage operations","File management in Databricks","Data persistence and retrieval"]}
{"type":"entity","name":"DatabricksAuthHelper","entityType":"repository","observations":["Databricks authentication helper","Located in src/backend/src/repositories/databricks_auth_helper.py","Authentication utilities","Token management","OAuth integration support"]}
{"type":"entity","name":"DatabricksVectorSearchEndpoint","entityType":"databricks_integration","observations":["Vector Search endpoint management","Located in DatabricksVectorEndpointRepository","Endpoint creation and configuration","Vector search API integration","Endpoint health monitoring and status"]}
{"type":"entity","name":"DatabricksVectorIndex","entityType":"databricks_integration","observations":["Vector index management system","Located in DatabricksVectorIndexRepository","Index creation, updates, and deletion","Vector embedding storage","Similarity search operations"]}
{"type":"entity","name":"DatabricksVectorSearchClient","entityType":"databricks_integration","observations":["Vector Search client interface","SDK integration for vector operations","Search query execution","Result ranking and filtering","Connection pool management"]}
{"type":"entity","name":"VectorEmbeddingPipeline","entityType":"databricks_integration","observations":["Text-to-vector conversion pipeline","Integration with DatabricksEmbedder","Batch embedding processing","Embedding model management","Vector dimension optimization"]}
{"type":"entity","name":"VectorSearchConfiguration","entityType":"databricks_integration","observations":["Vector search settings and parameters","Search algorithm configuration","Similarity threshold management","Result limit and filtering rules","Performance optimization settings"]}
{"type":"entity","name":"VectorIndexSynchronization","entityType":"databricks_integration","observations":["Index synchronization service","Real-time index updates","Batch synchronization processes","Delta sync operations","Index consistency management"]}
{"type":"entity","name":"VectorSearchMetrics","entityType":"databricks_integration","observations":["Vector search performance metrics","Query response time tracking","Index size and utilization","Search accuracy measurements","Cost optimization analytics"]}
{"type":"entity","name":"VectorSearchErrorHandler","entityType":"databricks_integration","observations":["Vector search error management","Retry logic for failed queries","Fallback search strategies","Error logging and alerting","Service degradation handling"]}
{"type":"entity","name":"DatabricksVolumeManager","entityType":"databricks_integration","observations":["Volume lifecycle management","Located in DatabricksVolumeRepository","Volume creation, mounting, and deletion","File system integration","Volume access control and permissions"]}
{"type":"entity","name":"DatabricksVolumeStorage","entityType":"databricks_integration","observations":["Volume file storage operations","File upload and download management","Directory structure maintenance","Large file handling","Storage quota management"]}
{"type":"entity","name":"VolumeFileMetadata","entityType":"databricks_integration","observations":["File metadata management in volumes","File indexing and cataloging","Metadata search capabilities","File versioning and history","Content type detection"]}
{"type":"entity","name":"VolumeAccessController","entityType":"databricks_integration","observations":["Volume access control system","Permission management for files","User and group access policies","Secure file sharing","Audit trail for file access"]}
{"type":"entity","name":"VolumeKnowledgeIngestion","entityType":"databricks_integration","observations":["Knowledge ingestion from volumes","Document processing pipeline","Text extraction and parsing","Knowledge graph population","Content indexing and embedding"]}
{"type":"entity","name":"VolumeSyncService","entityType":"databricks_integration","observations":["Volume synchronization service","Real-time file change detection","Incremental sync operations","Conflict resolution","Multi-volume coordination"]}
{"type":"entity","name":"VolumeMonitoringService","entityType":"databricks_integration","observations":["Volume monitoring and health checks","Storage utilization tracking","Performance metrics collection","Error detection and alerting","Capacity planning analytics"]}
{"type":"entity","name":"VolumeBackupService","entityType":"databricks_integration","observations":["Volume backup and recovery","Automated backup scheduling","Point-in-time recovery","Cross-region backup replication","Disaster recovery planning"]}
{"type":"entity","name":"DatabricksOBOAuthentication","entityType":"authentication_system","observations":["On-Behalf-Of authentication implementation","User impersonation for Databricks operations","Token delegation and management","Service account integration","Secure user context switching"]}
{"type":"entity","name":"OBOTokenManager","entityType":"authentication_system","observations":["OBO token lifecycle management","Token generation and validation","Token refresh and expiration","Secure token storage","Token revocation capabilities"]}
{"type":"entity","name":"UserContextManager","entityType":"authentication_system","observations":["User context switching service","Identity propagation across services","Permission inheritance","Context validation","Audit trail for context switches"]}
{"type":"entity","name":"DatabricksOAuthProvider","entityType":"authentication_system","observations":["Databricks OAuth2 integration","Authorization code flow","Client credentials management","Redirect URI handling","OAuth token exchange"]}
{"type":"entity","name":"WorkspaceAuthentication","entityType":"authentication_system","observations":["Databricks workspace authentication","Workspace-specific permissions","Multi-workspace support","Workspace switching capabilities","Resource access control per workspace"]}
{"type":"entity","name":"ServicePrincipalAuth","entityType":"authentication_system","observations":["Service principal authentication","Application-level authentication","Client secret management","Automated authentication flows","Service-to-service authentication"]}
{"type":"entity","name":"PersonalAccessTokenAuth","entityType":"authentication_system","observations":["Personal Access Token authentication","User-generated token management","Token scope and permissions","Token rotation policies","Legacy authentication support"]}
{"type":"entity","name":"AuthenticationMiddleware","entityType":"authentication_system","observations":["Authentication middleware layer","Request authentication validation","Token extraction and verification","Authentication flow routing","Error handling and fallbacks"]}
{"type":"entity","name":"JWTAuthenticationFlow","entityType":"authentication_flow","observations":["JSON Web Token authentication","Stateless authentication mechanism","Token-based session management","Claims-based authorization","Cross-service authentication"]}
{"type":"entity","name":"OAuth2AuthorizationFlow","entityType":"authentication_flow","observations":["OAuth 2.0 authorization code flow","Third-party authentication integration","User consent management","Authorization server integration","Secure token exchange"]}
{"type":"entity","name":"SessionBasedAuthentication","entityType":"authentication_flow","observations":["Traditional session-based auth","Server-side session storage","Cookie-based session tracking","Session timeout management","Session invalidation"]}
{"type":"entity","name":"APIKeyAuthentication","entityType":"authentication_flow","observations":["API key-based authentication","Programmatic access control","Rate limiting per API key","Key rotation and management","Service-to-service authentication"]}
{"type":"entity","name":"AuthenticationFlowOrchestrator","entityType":"authentication_system","observations":["Coordinates multiple auth flows","Flow selection based on context","Fallback authentication strategies","Authentication flow monitoring","Performance optimization across flows"]}
{"type":"entity","name":"AuthorizationManager","entityType":"authentication_system","observations":["Authorization and permission management","Role-based access control (RBAC)","Resource-level permissions","Permission inheritance and delegation","Authorization policy enforcement"]}
{"type":"entity","name":"AuthenticationAuditService","entityType":"authentication_system","observations":["Authentication event logging","Security audit trail","Failed authentication tracking","Compliance reporting","Suspicious activity detection"]}
{"type":"entity","name":"AuthenticationCacheService","entityType":"authentication_system","observations":["Authentication result caching","Token validation caching","Permission cache management","Cache invalidation strategies","Performance optimization"]}
{"type":"entity","name":"KnowledgeVolumeConfig","entityType":"configuration","observations":["Active Databricks config ID 16 in PostgreSQL","knowledge_volume_enabled = true","knowledge_volume_path = 'users.nehme_tohme.knowledge'","Frontend is browsing wrong path: main.default.knowledge","API endpoint works: /api/v1/databricks/knowledge/browse/{path}","Volume is accessible but empty - no files uploaded yet","FIXED: Backend now correctly resolves to user_admin_admin_com group in development","Volume path users.nehme_tohme.knowledge is correct and accessible","Authentication hierarchy working: OBO > API key service > env token","Group context resolution working for both production and development","Configuration for Databricks volume integration","Database stores volume paths and access settings","Actual files stored in Databricks Unity Catalog volumes","Volume configuration separate from content storage","Authentication and path resolution handled by config"]}
{"type":"entity","name":"BrowseVolumeIssue","entityType":"bug","observations":["Frontend browseVolumeFiles function uses hardcoded 'main.default.knowledge'","Should get volume path from databricksConfig.knowledge_volume_path","Database shows correct path: users.nehme_tohme.knowledge","API returns empty array [] for both paths - volumes are empty","Need to upload files first to test Browse Volume functionality","BREAKTHROUGH: Direct Databricks API shows 1 file in volume","browse_volume_files service looks correct - should return files","Issue may be in authentication context between frontend and backend","Frontend may not be passing proper group context or user tokens","Need to test with authentication headers to simulate frontend call","ROOT CAUSE FOUND: Missing X-Forwarded-Email header in API calls","Backend requires group context to find correct Databricks configuration","Without email header, backend uses default group instead of user_admin_admin_com","Test confirmed: API works with X-Forwarded-Email: admin@admin.com","PRODUCTION ISSUE: Frontend not getting real user context from environment","Need proper authentication flow, not mocking","SOLUTION IMPLEMENTED: Modified dependencies.py to use admin@admin.com as default in DEBUG_MODE","Production-ready: In production, Databricks Apps provides X-Forwarded-Email automatically","Local development: Falls back to admin@admin.com when no email headers present","CONFIRMED WORKING: API now returns volume directory correctly","Next step: Test frontend Browse Volume UI to confirm end-to-end functionality"]}
{"type":"entity","name":"KasalDatabase","entityType":"database","observations":["Local development uses kasal.db SQLite database","Database located at src/backend/kasal.db","Production uses PostgreSQL database","Contains all application data including knowledge sources, documents, and crew configurations","Database running on localhost PostgreSQL","Username: postgres, Password: postgres","Database name: kasal","Accessible via psql -h localhost -U postgres -d kasal","Stores ALL operational and configuration data","Execution runs, process logs, audit trails","User accounts, crew configurations, agent definitions","API keys, authentication settings, workspace configs","System logs, execution history, status tracking","No vector data - pure relational/operational data"]}
{"type":"entity","name":"DocumentKnowledgeIssue","entityType":"bug","observations":["PROBLEM: Document content chunks are not being added to task context during crew execution","ROOT CAUSE: Knowledge sources are configured per-agent but tasks don't inherit or access agent knowledge sources","CURRENT FLOW: Agent knowledge sources are created and attached to agents only","MISSING LINK: Task context should include content chunks from agent's knowledge sources","EVIDENCE: ProcessCrewExecutor logs show knowledge_sources in agent config but tasks don't access them","IMPACT: Crews can't use uploaded document content during task execution","SOLUTION IMPLEMENTED: Modified create_task function in task_helpers.py","FIX: Added knowledge source content extraction in task creation process","IMPLEMENTATION: Extract content chunks from agent.knowledge_sources and prepend to task description","HANDLES: String knowledge sources, vector sources with chunk_sources, document collections","FALLBACK: Calls add() method to trigger loading if content not immediately available","FORMAT: Prepends structured knowledge context to task description with clear delimiters","ERROR HANDLING: Graceful degradation if knowledge extraction fails","LOCATION: Lines 386-460 in src/engines/crewai/helpers/task_helpers.py","STATUS: Ready for testing with uploaded documents"]}
{"type":"entity","name":"Kasal_Agent_ID","entityType":"identifier","observations":["UUID string generated by generate_uuid()","Primary key in Agent model (models/agent.py line 19)","Stable unique identifier across system","Used for database relationships and foreign keys","Should be used for vector index agent access control","Successfully implemented in vector index agent_ids field","Used in DatabricksVectorKnowledgeSource for access control","Passed from crew_preparation.py to knowledge_factory.py","Stored in vector index document records as JSON array"]}
{"type":"entity","name":"CrewAI_Agent_Name","entityType":"identifier","observations":["Display name used in CrewAI configurations","Fallback from agent.name, agent.id, or agent.role","Used as key in crew_preparation.py agents dictionary","Not unique across groups","Should NOT be used for vector index access control"]}
{"type":"entity","name":"Agent_ID_Resolution","entityType":"pattern","observations":["agent_config.get('id') contains Kasal Agent UUID","agent_config.get('name') contains display name","Pattern: agent_name = config.get('name', config.get('id', config.get('role')))","agent_id = config.get('id', agent_name)","Found in crew_preparation.py around line 331","Implementation completed in crew_preparation.py line 379","Knowledge factory call now passes agent_id parameter","Vector index records include agent_ids field for filtering"]}
{"type":"entity","name":"Vector_Index_Access_Control","entityType":"feature","observations":["Implemented agent-based filtering in task_helpers.py","Tasks now search vector index with agent_id filter","Uses agent_ids field to determine document access permissions","Replaces direct knowledge source content extraction","Provides proper isolation between agents and their knowledge"]}
{"type":"entity","name":"DatabricksKnowledgeRouter","entityType":"api_router","observations":["Knowledge source management for Databricks","File upload and vector search operations","Browse volume files endpoint","Vector search endpoint","Located in /api/databricks/knowledge routes","Recently modified for stop execution feature","Handles Databricks volume and vector search integration"]}
{"type":"entity","name":"FlowsRouter","entityType":"api_router","observations":["Flow/workflow management endpoints","CRUD operations for flows","Flow execution management","Flow configuration and validation","Located in /flows routes"]}
{"type":"entity","name":"ExecutionsRouter","entityType":"api_router","observations":["Process execution endpoints","Start/stop/pause execution operations","Real-time execution status","Execution monitoring and control","Located in /executions routes"]}
{"type":"entity","name":"ModelsRouter","entityType":"api_router","observations":["LLM model configuration endpoints","Model provider management","Model parameter configuration","Model validation and testing","Located in /models routes"]}
{"type":"entity","name":"DatabricksRouter","entityType":"api_router","observations":["General Databricks integration endpoints","Databricks configuration management","Authentication and workspace setup","Located in /databricks routes"]}
{"type":"entity","name":"FlowService","entityType":"service","observations":["Flow/workflow business logic","Located in src/backend/src/services/flow_service.py","Flow lifecycle management","Flow validation and configuration","Orchestrates flow execution workflow"]}
{"type":"entity","name":"ExecutionService","entityType":"service","observations":["Process execution business logic","Located in src/backend/src/services/execution_service.py","Execution lifecycle management","Status tracking and monitoring","Coordinates with execution repositories"]}
{"type":"entity","name":"ModelConfigService","entityType":"service","observations":["LLM model configuration management","Located in src/backend/src/services/model_config_service.py","Model provider configuration","Model parameter validation","Model testing and validation"]}
{"type":"entity","name":"DatabricksService","entityType":"service","observations":["General Databricks integration service","Located in src/backend/src/services/databricks_service.py","Databricks workspace management","Authentication and configuration","General Databricks operations"]}
{"type":"entity","name":"UserService","entityType":"service","observations":["User account management","Located in src/backend/src/services/user_service.py","User authentication and profiles","User preference management","Group association management","Has comprehensive unit tests for first admin setup","Tests cover existing user, new user with no groups, new user with existing groups","Tests verify username uniqueness generation"]}
{"type":"entity","name":"ToolService","entityType":"service","observations":["Tool management and configuration","Located in src/backend/src/services/tool_service.py","Tool parameter validation","Tool usage tracking","Tool integration management","Provides tool configurations to ToolFactory during initialization","ToolFactory._load_available_tools_async() uses ToolService.get_all_tools()","Stores tool metadata that ToolFactory uses to instantiate actual tool objects","Tool configurations include: id, title, config (JSON), enabled status","ToolFactory caches tools by both ID and title for efficient lookup","Repository pattern implementation for tool persistence","Handles group-based tool filtering and overrides","Default tools (group_id=null) visible to all groups","Group-specific tools override defaults by title","Returns ToolResponse with id, title, description, config, enabled","Supports CRUD operations: create, update, delete, toggle","Tool configuration stored as JSON in database","Integration point between database and ToolFactory"]}
{"type":"entity","name":"AgentService","entityType":"service","observations":["Agent configuration management","Located in src/backend/src/services/agent_service.py","Agent parameter validation","Agent performance tracking","Agent-tool relationship management"]}
{"type":"entity","name":"TaskService","entityType":"service","observations":["Task management and configuration","Located in src/backend/src/services/task_service.py","Task parameter validation","Task execution tracking","Task-agent relationship management"]}
{"type":"entity","name":"AuthService","entityType":"service","observations":["JWT token management and validation service","OAuth2 flow coordination with Databricks","User authentication and session management","Password hashing and verification","Token refresh and revocation logic","Referenced by AuthRouter but not yet documented","Handles login, logout, and refresh token operations","CURRENT USAGE: Only used by auth_router.py - not enforced across business logic endpoints","ARCHITECTURAL GAP: Main business services (AgentService, CrewService, TemplateService, ExecutionService) do not use authentication dependencies","AUTHENTICATION ENDPOINTS: Only auth_router.py and identity_providers_router.py use get_current_user/get_current_active_user","FUTURE PURPOSE: Designed for upcoming privilege/RBAC logic implementation across all business endpoints","COMPREHENSIVE CAPABILITIES: Full JWT authentication system with user registration, login, token refresh, password management, external OAuth support","READY FOR EXPANSION: Service layer architecture supports adding authentication dependencies to any business service","TECHNICAL DEBT: Application currently operates without authentication enforcement on core business operations","IMPLEMENTATION STRATEGY: When privilege logic is added, business services can easily integrate via dependency injection pattern: get_current_user dependency","Removed unused authenticate_with_external_provider method","Now focuses on username/password authentication only"]}
{"type":"entity","name":"EmailService","entityType":"service","observations":["Email notification and communication service","SMTP integration for transactional emails","Template-based email composition","Execution completion notifications","Password reset email handling","Async email queue management"]}
{"type":"entity","name":"ValidationService","entityType":"service","observations":["Cross-cutting validation logic service","Business rule validation beyond Pydantic schemas","Complex validation patterns for workflows","Agent and task configuration validation","Data integrity checks across entities","Custom validation rule engine"]}
{"type":"entity","name":"CacheService","entityType":"service","observations":["Application-level caching service","Redis integration for distributed caching","Cache invalidation strategies","Performance optimization for repeated operations","Model configuration and template caching","Execution result caching for reuse"]}
{"type":"entity","name":"BackgroundTaskService","entityType":"service","observations":["Async job management and scheduling service","Celery or similar task queue integration","Background execution coordination","Long-running process management","Task retry and error handling","Scheduled workflow execution"]}
{"type":"entity","name":"AuditService","entityType":"service","observations":["Compliance and audit logging service","User action tracking and attribution","Data access and modification logs","Security event monitoring","Regulatory compliance support","Audit trail generation and export"]}
{"type":"entity","name":"LiteLLMService","entityType":"service","observations":["LLM provider abstraction service","Unified interface across Databricks, OpenAI, Anthropic","Model switching and fallback logic","Rate limiting and cost optimization","Token usage tracking and billing","Provider-specific configuration management"]}
{"type":"entity","name":"WebhookService","entityType":"service","observations":["External webhook management service","Webhook registration and validation","Event-driven integration with external systems","Execution status notifications","Retry logic for failed webhook deliveries","Security verification for incoming webhooks"]}
{"type":"entity","name":"FileStorageService","entityType":"service","observations":["File handling abstraction service","Local and cloud storage coordination","File upload and download management","Temporary file lifecycle management","File metadata and indexing","Storage quota and cleanup policies"]}
{"type":"entity","name":"SearchService","entityType":"service","observations":["Full-text search service beyond vector search","Elasticsearch or similar search engine integration","Multi-entity search across workflows, agents, tasks","Search indexing and relevance scoring","Faceted search and filtering","Search analytics and optimization"]}
{"type":"entity","name":"KnowledgeSourceFactory","entityType":"factory","observations":["Factory for creating knowledge sources from configuration","Avoids JSON serialization issues by creating objects in subprocess","Located in engines/crewai/knowledge/knowledge_factory.py","Supports databricks_volume and string knowledge source types","Handles execution isolation and agent access control"]}
{"type":"entity","name":"SourceFilteredStorage","entityType":"wrapper","observations":["Storage wrapper for automatic source path filtering","Part of DatabricksVectorKnowledgeSource implementation","Intercepts search calls to add file path filters","Enables knowledge source isolation by file paths","Handles both sync and async search operations"]}
{"type":"entity","name":"DuplicateDocumentIndexingIssue","entityType":"bug","observations":["Documents uploaded via UI get indexed 10+ times","Root cause identified in DatabricksKnowledgeService.upload_knowledge_file","Method has 3 upload paths that all call _embed_uploaded_file","SDK upload path, DBFS API path, and simulation path all embed separately","Need to consolidate embedding logic to execute only once","FIXED: Refactored upload_knowledge_file method","Consolidated embedding logic to execute only once","Added upload_successful and upload_method tracking","Removed duplicate embedding calls from SDK and DBFS paths","Single embedding execution at end regardless of upload method","Should prevent 10+ duplicate document entries in index","ADDITIONAL FIX: Added missing agent_ids handling to document memory type","Vector storage now properly processes agent_ids for knowledge files","agent_ids field was defined in DOCUMENT_SCHEMA but not implemented in save method","Fixed lines 301-309 in databricks_vector_storage.py","Now agent access control should work for uploaded knowledge files"]}
{"type":"entity","name":"AgentIDPrefixIssue","entityType":"bug","observations":["CrewAI adding agent_ prefix to clean UUIDs during processing","Frontend sends clean UUID: 3e084715-f8fe-4cfd-a224-021e7293ea7f","CrewAI logs show: agent_ids=['agent_agent-3e084715-f8fe-4cfd-a224-021e7293ea7f']","Root cause: CrewAI automatically prefixes 'agent_' to agent names internally","Agent configuration uses agent-UUID format which becomes agent_agent-UUID","Issue occurs in knowledge source creation chain","Located in crew_preparation.py line 325: agent_name derived from agent_config.get('id')","Flow system uses agent- prefix convention in frontend ReactFlow editor","CrewAI Agent constructor doesn't receive explicit name parameter","INCOMPLETE FIX: Runtime fix applied but upload process still broken","Vector index data shows agent_ids: null for all entries including knowledge_files","Both upload-time and runtime agent_ids issues need to be addressed","Upload process in databricks_knowledge_service.py not preserving agent_ids","Need to trace upload flow: frontend -> router -> service -> vector storage"]}
{"type":"entity","name":"KnowledgeStorageMismatchIssue","entityType":"bug","observations":["Knowledge files uploaded via UI go to main document index","Knowledge sources during execution create isolated per-execution collections","Two separate storage systems: document index vs execution-specific collections","Uploaded files not accessible during crew execution","Documents stored in users.nehme_tohme.document_embeddings_... index","Knowledge sources create knowledge_{group_id}_{execution_id} collections","Collection isolation prevents access to uploaded knowledge files","UPLOAD SIDE FIXED: Modified document memory type to use group_id from data","Line 312: record['group_id'] = data.get('group_id', self.crew_id)","Knowledge files will now use proper group context instead of hardcoded 'knowledge_files'","Upload side now stores documents with correct tenant group_id","QUERY SIDE FIXED: Modified knowledge source to use main document index","Updated DatabricksVectorKnowledgeSource.__init__ to use document_index","Added group_id and agent_ids filtering in SourceFilteredStorage.search","Knowledge sources now query main document index with proper filtering","group_id filter provides tenant isolation","agent_ids filter provides access control","Removed execution-specific collection creation"]}
{"type":"entity","name":"AgentMemoryRequirement","entityType":"requirement","observations":["Knowledge sources require agent memory to be enabled","Memory disabled agents cannot access Databricks Vector Search backend","This is a hard dependency - no workaround available","Always check agent.memory = true when configuring knowledge sources","Debugging checklist: 1) Agent memory enabled 2) File exists 3) Backend configured"]}
{"type":"entity","name":"TaskHelpers","entityType":"helper","observations":["Task creation and preparation utilities for CrewAI","Located in src/backend/src/engines/crewai/helpers/task_helpers.py","FIXED: Removed problematic manual vector search in task_helpers.py","Manual knowledge injection caused timing issues - backend not configured yet","Now relies on CrewAI's built-in knowledge source system for automatic retrieval","Agent knowledge sources will handle knowledge access during task execution","Eliminated 'No active Databricks backend found for knowledge search' error"]}
{"type":"entity","name":"ShortTermMemory","entityType":"memory_type","observations":["Temporary, session-based memory for agent interactions","Stores recent conversation context and query-response pairs","Located in databricks_vector_storage.py with 'short_term' type","Has 24-hour default TTL (Time-To-Live) for sliding window","Uses session_id to track conversation sessions","interaction_sequence field for ordering within sessions","Schema includes: id, content, query_text, session_id, interaction_sequence","Temporal fields: timestamp, created_at, ttl_hours","Context fields: metadata, crew_id, agent_id, group_id","Provenance tracking: llm_model, tools_used for audit trail","Embedding dimension: 1024 (databricks-gte-large-en model)","Used for maintaining conversation context during crew execution","Filters by crew_id for isolation between different crew runs","Supports similarity search for finding relevant past interactions"]}
{"type":"entity","name":"LongTermMemory","entityType":"memory_type","observations":["Persistent memory for storing completed task descriptions and outcomes","IMPORTANT: Stores task descriptions, NOT task outputs (by design)","Located in databricks_vector_storage.py with 'long_term' type","Used to find similar past tasks and retrieve suggestions","Schema includes: id, content, task_description, task_hash","Quality tracking: quality (0.0-1.0), importance (0.0-1.0) scores","task_hash field for exact task matching using MD5","Temporal fields: timestamp, last_accessed for retrieval tracking","Context fields: metadata, crew_id, agent_id, group_id","Provenance tracking: llm_model, tools_used for task completion audit","CrewAI passes LongTermMemoryItem objects with task, agent, expected_output","Designed for learning from past task executions","Helps agents leverage experience from previous similar tasks","No expiration - memories persist indefinitely for knowledge accumulation"]}
{"type":"entity","name":"EntityMemory","entityType":"memory_type","observations":["Knowledge graph for storing entities and their relationships","Located in databricks_vector_storage.py with 'entity' type","Schema includes: id, entity_name, entity_type, description","relationships field stores JSON array of related entities","Input format: 'EntityName(Type): Description' parsed by regex","Enhanced fallback parsing for various entity formats","Temporal tracking: timestamp for entity creation/updates","Context fields: crew_id, agent_id, group_id for isolation","Provenance tracking: llm_model, tools_used for entity extraction","Supports relationship-based retrieval when enabled","EntityRelationshipRetriever for graph traversal (max_hops=2)","relationship_weight=0.3 for balancing semantic vs graph search","get_entities() method returns list of known entity names","Used for building knowledge about people, places, concepts","Enables context-aware understanding through entity relationships"]}
{"type":"entity","name":"DocumentMemory","entityType":"memory_type","observations":["Storage for uploaded knowledge documents and files","Located in databricks_vector_storage.py with 'document' type","Schema includes: id, title, content, source, document_type","Chunking support: section, chunk_index, chunk_size, parent_document_id","agent_ids field for agent-specific access control (JSON array)","group_id for tenant isolation in multi-tenant environment","Temporal fields: created_at, updated_at for versioning","doc_metadata field for storing additional document metadata","Used by DatabricksVectorKnowledgeSource for knowledge retrieval","Documents chunked during upload process via UI","Filters by group_id instead of crew_id for document queries","Supports file types: md, pdf, txt, and others","Integration with Databricks Unity Catalog volumes for file storage","No runtime chunking - documents pre-processed during upload"]}
{"type":"entity","name":"MCPIntegration","entityType":"integration_module","observations":["Located in src/backend/src/engines/crewai/tools/mcp_integration.py","Implements three-tier MCP configuration system: Global > Agent-level > Task-level","Priority Order: Task-level > Agent-level > Global (when multiple servers conflict)","Effective servers = Global  Agent-specific  Task-specific (deduplicated)","Key method: resolve_effective_mcp_servers() combines global and explicit server selections","Key method: collect_agent_mcp_requirements() maps agents to required MCP servers based on tasks","Key method: create_mcp_tools_for_agent() generates CrewAI-compatible tools for agents","Key method: create_mcp_tools_for_task() generates CrewAI-compatible tools for tasks","Handles both new dict format and legacy array format for MCP_SERVERS config","Supports Databricks OBO authentication for MCP servers","Creates server connection parameters including auth headers and timeouts","Prefixes tool names with server name for identification (e.g., databricks_genie_get_space)","Validates MCP configuration structure before processing","Handles MCP server failures gracefully without stopping crew execution"]}
{"type":"entity","name":"MCPAdapter","entityType":"adapter","observations":["Located in src/backend/src/engines/common/mcp_adapter.py","Uses official MCP client library (mcp.client.streamable_http)","Supports both SSE and Streamable MCP protocols","Authentication flow: OBO headers > API key > Environment variables","Tool discovery via ClientSession.list_tools() from MCP server","Converts MCP tool format to internal tool wrapper format","Handles connection initialization and session management","Supports timeout and retry configuration per server","Rate limiting support (default 60 requests/minute)","Maintains _initialized flag to track adapter readiness","Creates MCPTool wrappers for discovered tools","Handles both sync and async execution contexts"]}
{"type":"entity","name":"mcp_handler","entityType":"handler_module","observations":["Located in src/backend/src/engines/crewai/tools/mcp_handler.py","Global connection pool (_mcp_connection_pool) for adapter reuse","Global adapter tracking (_active_mcp_adapters) for cleanup","get_or_create_mcp_adapter() implements connection pooling logic","Pool key format: 'url_authtype' for HTTP or 'stdio_command' for stdio","create_crewai_tool_from_mcp() wraps MCP tools for CrewAI compatibility","Dynamic Pydantic model generation for tool input schemas","wrap_mcp_tool() handles event loop conflicts via process isolation","Special handling for Databricks Genie tools (get_space, start_conversation, create_message)","Fallback to direct Databricks API calls when MCP fails","run_in_separate_process() executes tools in isolated Python processes","stop_all_adapters() ensures clean shutdown of all MCP resources","Handles both async and sync execution contexts with ThreadPoolExecutor"]}
{"type":"entity","name":"MemoryIndexConfiguration","entityType":"configuration","observations":["Index naming convention: {catalog}.{schema}.{index_name}","Example format: ml.agents.short_term_memory","Four index types configured in DatabricksMemoryConfig:","short_term_index: Required, for short-term conversation memory","long_term_index: Optional, for task description persistence","entity_index: Optional, for entity knowledge graph","document_index: Optional, for uploaded knowledge documents","Indexes created in Unity Catalog with specified catalog and schema","Direct Access endpoint for memory indexes (dynamic data)","Storage Optimized endpoint for document indexes (static data)","Index names stored in databricks_config table in database","Group-specific index naming: {catalog}.{schema}.{memory_type}_{group_id}","Example: users.nehme_tohme.short_term_memory_user_admin_admin_com","Test index examples: test.catalog.short_term, test.catalog.long_term","Production naming: ml.agents.{memory_type} or users.{username}.{memory_type}"]}
{"type":"entity","name":"IndexSchemaStructure","entityType":"schema","observations":["SHORT_TERM_SCHEMA: 17 fields including embedding vector","LONG_TERM_SCHEMA: 14 fields for task persistence","ENTITY_SCHEMA: 12 fields for knowledge graph","DOCUMENT_SCHEMA: 17 fields for document storage","All schemas include 1024-dimension embedding field","Common fields across all: id, embedding, crew_id/group_id","Provenance fields: llm_model, tools_used, embedding_model","Version field for future schema migrations","Temporal fields vary by memory type (timestamp, created_at, last_accessed)","JSON fields for complex data: metadata, relationships, doc_metadata","Access control fields: agent_id (all types), agent_ids (documents only)","TTL field only in short-term memory for expiration"]}
{"type":"entity","name":"ToolFactory","entityType":"factory_class","observations":["Located in src/backend/src/engines/crewai/tools/tool_factory.py","Central factory class for creating and managing CrewAI tools","Manages 60+ built-in CrewAI tools from crewai_tools package","Imports: DallETool, SerperDevTool, FirecrawlTool, WebsiteSearchTool, FileWriterTool, etc.","Handles custom tools: PerplexityTool, GenieTool, DatabricksCustomTool, DatabricksJobsTool, PythonPPTXTool","API key management from database via ApiKeysService or environment variables","Key method: create() - Async factory method for initialization","Key method: initialize() - Loads available tools from database","Key method: create_tool() - Creates tool instances with configurations","Key method: _get_api_key_async() - Retrieves encrypted API keys from database","Key method: update_tool_config() - Updates tool configurations dynamically","Handles async/sync context switching with ThreadPoolExecutor","Tool configuration merging: base_config + tool_config_override","Special handling for tools requiring API keys (PerplexityTool, SerperDevTool, etc.)","Databricks tools support OBO authentication with user tokens","Resource cleanup with cleanup() and cleanup_after_crew_execution()","Tool implementations mapping in _tool_implementations dictionary","Pre-loads common API keys into environment during initialization","Supports result_as_answer parameter for tool responses","Configuration validation and parameter transformation per tool type","Manages tool lifecycle from initialization to cleanup","Maintains _available_tools dictionary cached by both ID and title","Implements _sync_load_available_tools() for synchronous contexts","Uses execute_db_operation_with_fresh_engine() to avoid transaction conflicts","Implements register_tool_implementation() for dynamic tool registration","Tool creation flow: get_tool_info() -> lookup implementation -> create_tool()","SerperDevTool: Maps endpoint_type to search_type parameter","SerperDevTool: Supports 'search' and 'news' endpoint types","FirecrawlCrawlWebsiteTool: Requires FIRECRAWL_API_KEY","FileWriterTool: Configurable default_directory, overwrite, encoding","NL2SQLTool: Database URI configuration with default postgres credentials","LinkupSearchTool: Enforced parameters with EnforcedLinkupSearchTool wrapper","LinkupSearchTool: Validates depth (standard/deep) and output_type parameters","All tools support result_as_answer parameter except LinkupSearchTool","Pre-loads API keys: SERPER_API_KEY, PERPLEXITY_API_KEY, OPENAI_API_KEY, FIRECRAWL_API_KEY, LINKUP_API_KEY, DATABRICKS_API_KEY","Error handling: Continues operation even if API key retrieval fails","Cleanup resources tracked for proper disposal after crew execution","Tool configuration precedence: tool_config_override > base_config > defaults","Uses _run_in_new_loop() helper for async operations in threads","Implements __del__() for automatic cleanup on garbage collection"]}
{"type":"entity","name":"PerplexityTool","entityType":"custom_tool","observations":["Located in src/backend/src/engines/crewai/tools/custom/perplexity_tool.py","Custom tool for Perplexity AI search integration","Requires PERPLEXITY_API_KEY for authentication","Supports result_as_answer parameter","API key retrieved from database or environment","Part of custom tools imported by ToolFactory","Checks os.environ.get('PERPLEXITY_API_KEY') first","Falls back to ApiKeysService if not in environment","Uses ThreadPoolExecutor for async key retrieval","Removes perplexity_api_key field to avoid keyword arg error","Passes api_key parameter to tool constructor"]}
{"type":"entity","name":"GenieTool","entityType":"custom_tool","observations":["Located in src/backend/src/engines/crewai/tools/custom/genie_tool.py","Databricks Genie integration for AI assistance","Supports OAuth/OBO authentication with user tokens","Configuration: spaceId, DATABRICKS_HOST, DATABRICKS_API_KEY","Special handling for space_id/spaceId parameter variations","Token authentication priority: user_token > API key","Retrieves DATABRICKS_HOST from DatabricksService if not in config","Part of Databricks tool suite in ToolFactory","Checks UserContext for user token if not provided","Falls back to group context for access token","Uses OAuth if user_token available, otherwise API key","Supports both spaceId and space_id parameter names","Checks tool_config_override first for spaceId","Auto-detects DATABRICKS_HOST if in Databricks Apps environment","Logs token preview for debugging OBO authentication","Optimized best practices documentation to reflect actual implementation","spaceId is configured at tool initialization level, not in task descriptions","Tool expects simple 'question' field in natural language","Handles all Genie API complexity internally including authentication and conversation management","Returns markdown-formatted answers directly","Best practices now emphasize natural language questions over technical specifications","Added important context limitation warning to avoid requesting large datasets","Emphasized requesting aggregated data, summaries, and top N results","Updated examples to show limited result sets (e.g., 'top 10 products')","Added new usage tip about requesting summaries instead of raw data to prevent context issues"]}
{"type":"entity","name":"DatabricksCustomTool","entityType":"custom_tool","observations":["Located in src/backend/src/engines/crewai/tools/custom/databricks_custom_tool.py","Custom Databricks operations tool","Configuration: catalog, schema, warehouse_id","Supports OBO authentication with user tokens","Retrieves DATABRICKS_HOST from service or environment","Uses UserContext.get_user_token() for authentication","Part of Databricks tool suite in ToolFactory","Extracts user token from UserContext.get_user_token()","Configuration parameters: catalog, schema, warehouse_id","Retrieves DATABRICKS_HOST from environment or DatabricksService","Formats workspace_url with https:// prefix if missing","Uses ThreadPoolExecutor for async operations in sync context","Passes tool_config dictionary to tool constructor"]}
{"type":"entity","name":"DatabricksJobsTool","entityType":"custom_tool","observations":["Located in src/backend/src/engines/crewai/tools/custom/databricks_jobs_tool.py","Databricks job management and execution","Supports OBO authentication with user tokens","Configuration similar to DatabricksCustomTool","Retrieves DATABRICKS_HOST dynamically","Part of Databricks tool suite in ToolFactory","Similar authentication pattern as DatabricksCustomTool","Retrieves user token for OBO authentication","Gets DATABRICKS_HOST dynamically from service","Uses same workspace URL formatting logic","Supports job execution and monitoring operations"]}
{"type":"entity","name":"PythonPPTXTool","entityType":"custom_tool","observations":["Located in src/backend/src/engines/crewai/tools/custom/python_pptx_tool.py","PowerPoint presentation generation tool","Uses python-pptx library for PPTX creation","Configured through tool_config parameters","Part of custom tools in ToolFactory"]}
{"type":"entity","name":"agent_helpers","entityType":"helper_module","observations":["Located in src/backend/src/engines/crewai/helpers/agent_helpers.py","Helper functions for creating CrewAI agents","Key function: create_agent() - Creates Agent instances with tools","Resolves tool IDs to tool names via ToolService","Extracts tool configurations from agent tool_configs","Handles special tool_override for specific tools (e.g., GenieTool spaceId)","Creates tool instances with result_as_answer from config","Falls back to tool names if ToolFactory not provided (with warning)","Logs tool creation success/failure for debugging","Passes tool_config_override to ToolFactory.create_tool()","Integrates MCP tools via MCPIntegration.create_mcp_tools_for_agent()","Configures LLM for agents using LLMManager","Handles temperature overrides for agent LLMs","Manages knowledge sources for agents","Sets up memory configuration for agents"]}
{"type":"entity","name":"task_helpers","entityType":"helper_module","observations":["Located in src/backend/src/engines/crewai/helpers/task_helpers.py","Helper functions for creating CrewAI tasks","Key function: create_task() - Creates Task instances with tools","Similar tool resolution pattern as agent_helpers","Extracts task-specific tool configurations","Supports tool_override per task for dynamic configuration","Creates MCP tools via MCPIntegration.create_mcp_tools_for_task()","Handles both explicit task tools and inherited agent tools","Logs detailed tool creation process for troubleshooting","Configures output formats (JSON, Pydantic, File)","Manages task dependencies and context","Sets up callbacks for task execution","Handles human input requirements for tasks"]}
{"type":"entity","name":"ApiKeysService","entityType":"service","observations":["Located in src/backend/src/services/api_keys_service.py","Manages encrypted API keys in database","Key method: find_by_name() - Retrieves API key by name","Uses EncryptionUtils for key encryption/decryption","Provides secure storage for sensitive API credentials","Used by ToolFactory to retrieve tool-specific API keys","Supports CRUD operations on API keys","Handles keys: PERPLEXITY_API_KEY, SERPER_API_KEY, DATABRICKS_API_KEY, etc."]}
{"type":"entity","name":"ToolRepository","entityType":"repository","observations":["Located in src/backend/src/repositories/tool_repository.py","Database access layer for tool configurations","Manages tool persistence in database","Used by ToolService for data operations","Handles tool CRUD operations at database level","Stores tool metadata: id, title, description, config, enabled"]}
{"type":"entity","name":"ToolBestPracticesJSON","entityType":"configuration_file","observations":["Stores best practices for CrewAI task creation","Contains templates and examples for GenieTool integration","Includes Reveal.js presentation patterns","Provides error handling strategies","Located at src/backend/src/seeds/tool_best_practices.json"]}
{"type":"entity","name":"DocumentationSeeder","entityType":"service","observations":["Enhanced to load best practices from JSON","Creates embeddings for both CrewAI docs and tool best practices","Processes structured content for better task generation","Supports extensible tool integration patterns"]}
{"type":"entity","name":"TaskGenerationService","entityType":"service","observations":["Service for generating CrewAI tasks using LLM","Now includes vector search for documentation enrichment","Retrieves 5 relevant documentation chunks by default","Searches for task templates and best practices","Enhances context with agent information if provided","Uses DocumentationEmbeddingService for similarity search","Located at src/backend/src/services/task_generation_service.py"]}
{"type":"entity","name":"AgentGenerationService","entityType":"service","observations":["Service for generating CrewAI agents using LLM","Now includes vector search for documentation enrichment","Retrieves 5 relevant documentation chunks by default","Searches for agent patterns and tool best practices","Enhances context with tool-specific documentation","Uses DocumentationEmbeddingService for similarity search","Located at src/backend/src/services/agent_generation_service.py"]}
{"type":"entity","name":"CrewGenerationService","entityType":"service","observations":["Service for generating complete crews with agents and tasks","Already uses vector search for documentation enrichment","Retrieves 3 relevant documentation chunks by default","Enhanced context improves crew quality","Located at src/backend/src/services/crew_generation_service.py"]}
{"type":"entity","name":"AgentServiceCreateIssue","entityType":"bug","observations":["Error: AgentService.create() missing 1 required positional argument: 'obj_in'","Located in crew_preparation.py line 1556","Method name collision between class method create(session) and instance method create(obj_in)","AgentService has both a factory class method and an instance creation method with same name","Fix: Use AgentService(session) constructor directly instead of AgentService.create(session)","Fixed by changing AgentService.create(session) to AgentService(session) at line 1556","Solution implemented: Use constructor directly to avoid naming collision","The class method create() was conflicting with inherited instance method create(obj_in)"]}
{"type":"entity","name":"LakebaseService","entityType":"service","observations":["Service for managing Databricks Lakebase instances","Follows clean architecture pattern inheriting from BaseService","Authentication fallback: OBO  PAT from DB  Environment variables","Uses ApiKeysService.get_provider_api_key('databricks') for PAT retrieval","Changed workspace_client from property to async method get_workspace_client()","Implements instance creation, configuration management, and data migration","Generates temporary tokens per request for secure connections","Fixed ApiKeysService import: using api_keys_service (plural) not api_key_service","Using class method ApiKeysService.get_provider_api_key('databricks') for PAT retrieval","Fixed async workspace_client calls: all w.database calls now properly await get_workspace_client()","Added better error handling for quota limits and instance not found errors","DatabaseConfigRepository initialized correctly with (LakebaseConfig, session) parameters","Fixed JSON column serialization issue during migration - dicts and lists must be JSON.dumps() serialized","Fixed PostgreSQL column name escaping - column names must be quoted with double quotes","Added proper type handling for boolean, None, and JSON columns in migrate_existing_data()","Migration now converts Python dict/list to JSON strings for JSONB columns in Lakebase","Added comprehensive JSON column mapping for all tables to correctly identify which columns are JSON type","Added DELETE FROM table before migration to handle duplicate key violations from partial migrations","Fixed ExecutionHistory result field - now properly handles plain strings by wrapping them in JSON","Migration now differentiates between JSON columns and regular columns based on SQLAlchemy model definitions","Enhanced logging with clear visual indicators for migration phases","Added progress tracking showing [n/total] tables during migration","Added migration duration calculation and summary statistics","Added visual markers:  for start,  for completion,  for stats","Logs now clearly show when system switches to Lakebase after migration","Fixed JSON column handling for plain string values - now validates if string is already JSON before wrapping","Plain strings like 'hello world' are now properly wrapped as JSON strings ('\"hello world\"')","Added try/except block to detect valid JSON strings vs plain text","Handles all data types correctly: dict/list  JSON, valid JSON string  keep, plain string  wrap, None  null","Added comprehensive boolean column mapping to convert SQLite integers (0/1) to PostgreSQL booleans","Added datetime column mapping to convert string timestamps to datetime objects","Supports both ISO format and simple datetime string parsing","Fixed Lakebase instance state check to accept both AVAILABLE and READY states","Migration now properly handles type conversion for all SQLite to PostgreSQL data types"]}
{"type":"entity","name":"DatabaseConfigRepository","entityType":"repository","observations":["Repository for database configuration persistence","Inherits from BaseRepository","Fixed: Uses self.model instead of self.model_class","Implements upsert, get_by_key, and delete_by_key operations","Stores Lakebase configurations with JSON values"]}
{"type":"entity","name":"CrewExecutionConfig","entityType":"service","observations":["Manages crew execution configuration in crewai_execution_service.py","Process type properly extracted from inputs and placed in crew section","Manager LLM configuration added when hierarchical process selected","Planning and reasoning LLMs included in crew configuration","Fixed configuration in lines 281-317 to support hierarchical process"]}
{"type":"entity","name":"ExecutionTraceOrphanFix","entityType":"bug_fix","observations":["Fixed orphan ExecutionHistory entries with null group_id","Root cause: execution_trace_repository.py auto-created execution records for non-existent job_ids","Auto-created records had status='running', run_name='Auto-created for trace', inputs={'auto_created': true}","Solution: Removed auto-creation logic, now raises ValueError for missing jobs","Updated error handling in ExecutionTraceService, logging_callbacks.py, and trace_management.py","Tests confirm no orphan records will be created going forward"]}
{"type":"entity","name":"PermissionSystem","entityType":"module","observations":["Located at src/core/permissions.py","Implements three-tier role-based access control","Roles: Admin (full access), Editor (create/edit), Operator (execute/monitor)","Uses decorators for endpoint protection","Integrates with GroupContext for role validation","Successfully implemented in agents_router.py","Successfully implemented in tasks_router.py","Operators have read-only access to agents/tasks/crews","Editors can create/update/delete agents/tasks/crews","Admins can do everything including delete all operations","Successfully implemented in crews_router.py","All core workflow routers now have role-based permissions","Permission checks use check_role_in_context() function","Personal workspaces (user_* prefix) treated as admin access","Implementation complete for agents, tasks, and crews routers"]}
{"type":"entity","name":"GroupContext","entityType":"class","observations":["Located in src/utils/user_context.py","Enhanced to include user_role field","Stores user's role in the selected group","Personal workspaces (user_* prefix) have no role (treated as admin)","Retrieves role from group_service.get_user_groups_with_roles()"]}
{"type":"entity","name":"GroupService","entityType":"service","observations":["Manages groups and group memberships","Added get_total_group_count method to check if groups exist","Added create_first_admin_group_for_user method for first admin setup","Creates admin group and assigns user with ADMIN role","Uses GroupRepository and GroupUserRepository","Handles first user admin setup when no groups exist","Has unit tests for create_first_admin_group_for_user","Tests verify correct group ID generation","Tests verify admin role assignment","Tests verify email domain extraction"]}
{"type":"entity","name":"GroupPrivilegeValidation","entityType":"bug","observations":["Problem identified: Double admin privilege check in POST /groups/ endpoint","First check (AdminUserDep) validates system-wide admin role - PASSES","Second check (check_role_in_context) validates group-level admin role - FAILS","Issue: GroupContext.from_email() not finding user's group membership or role","User admin@admin.com exists in group admin_group_admin_com with admin role","X-Group-Id header may not be sent from frontend causing role lookup failure","Fixed by adding fallback check for admin@admin.com in check_role_in_context","When X-Group-Id header is not sent, group_context.user_role is None","Added special case for admin@admin.com to bypass group role check for system operations","This allows the first admin user to create groups without X-Group-Id header","Minimal change that doesn't affect other routers using check_role_in_context pattern","Standardized header name from 'X-Group-Id' to 'group_id' to match database column names","Updated backend dependencies.py to accept 'group_id' header","Updated frontend ApiConfig.ts to send 'group_id' header","This eliminates naming confusion and follows database naming conventions","All models use 'group_id' as the column name for consistency","RESOLVED: Fixed naming conflict between path parameter and header","Used x_group_id as parameter name with alias='group_id' to read from header","This avoids FastAPI assertion error 'Cannot use Header for path param'","Frontend sends 'group_id' header, backend receives it via alias","Maintains consistency with database column naming convention","ISSUE RESOLVED: Personal workspace group_id now properly inherits admin role","When user_admin_admin_com is sent as group_id, system checks user's actual groups","If user has admin role in any real group, that role is used for authorization","Personal workspace (user_*) is added as primary group while keeping actual groups","This allows admin operations even when personal workspace is selected in frontend","Updated to properly handle group selection for both filtering and authorization","When a real group is selected: Use that group's role and filter data to that group only","When personal workspace is selected: Filter data to personal workspace only","Personal workspace admin inheritance: Only if user has admin in ANY group","This preserves data isolation while allowing system-admin operations","GroupSelector behavior: Switching groups changes both data visibility and role permissions","FINAL SOLUTION: Separated authorization from data isolation","Added highest_role field to track user's highest privilege across ALL groups","user_role: Role in the selected group/workspace (for contextual permissions)","highest_role: Highest role across all groups (for system-wide authorization)","Personal workspace inherits highest_role for authorization","Data isolation: primary_group_id always scopes data to selected group/workspace","Users can perform admin operations from any workspace if they have admin in ANY group","When switching groups, data visibility changes but admin capabilities remain"]}
{"type":"entity","name":"RBAC_Cleanup_TodoList","entityType":"task_list","observations":["TODO: Search for DatabricksRoleService and related complex RBAC components","TODO: Identify Role, UserRole, Permission, RolePermission tables and models","TODO: Find privilege-based decorators and complex authorization logic","TODO: Search for external identity and SCIM integration components","TODO: Identify unused authentication services and dependencies","TODO: Remove obsolete database tables and models","TODO: Clean up unused imports and service classes","TODO: Update tests to remove complex auth test scenarios"]}
{"type":"entity","name":"DatabaseConnectionPoolIssue","entityType":"issue","observations":["SQLAlchemy garbage collector warnings when asyncpg connections not returned to pool","Double commit/rollback pattern in database_router.py breaks session lifecycle","Lakebase session factory shouldn't handle transactions internally","Fix requires removing redundant transaction management at factory level","Keep transaction control at FastAPI dependency level only","Affects production performance and causes memory leaks","Solution documented in /tmp/kasal_connection_pool_fix_plan.md","Fix implemented: Removed double session management in 3 files","database_router.py: Removed duplicate commit/rollback when delegating to lakebase","lakebase_session.py: Factory no longer handles transactions internally","session.py: Added explicit session.close() in finally block","Test results show significant improvement but some ResourceWarnings remain","Remaining warnings likely from asyncpg connection reuse in development mode","Production deployment with proper connection pooling should eliminate all warnings","RESOLVED: Issue fixed by using async context manager properly","Final solution: async with async_session_factory() as session","Must use async with for sessionmaker - not direct call","Session auto-closes when exiting async context manager","No more SQLAlchemy garbage collector warnings after fix","Remaining asyncpg ResourceWarnings are lower-level and don't affect production"]}
{"type":"entity","name":"PermissionsCore","entityType":"security_component","observations":["New simplified permission system in src/backend/src/core/permissions.py","Decorator-based permission enforcement","Implements @require_roles(['admin', 'editor', 'operator'])","Replaces complex privilege-based RBAC system","Three-tier role model: admin, editor, operator"]}
{"type":"entity","name":"DatabaseRouter","entityType":"database_component","observations":["Database routing component in src/backend/src/db/database_router.py","Routes database connections between regular DB and Lakebase","Supports multi-database architecture","Configuration-driven database selection"]}
{"type":"entity","name":"LakebaseSession","entityType":"database_component","observations":["Lakebase database session management in src/backend/src/db/lakebase_session.py","PostgreSQL-compatible session handling for Databricks Lakebase","Token-based authentication integration","Supports Databricks Apps deployment"]}
{"type":"entity","name":"DatabricksKnowledgeSearchTool","entityType":"ai_tool","observations":["Custom CrewAI tool in src/backend/src/engines/crewai/tools/custom/databricks_knowledge_search_tool.py","Replaces knowledge source approach with tool-based search","Integrates with DatabricksKnowledgeService","Provides explicit control over knowledge retrieval"]}
{"type":"entity","name":"DatabaseConfig","entityType":"data_model","observations":["Database configuration model in src/backend/src/models/database_config.py","Manages database connection settings","Supports multiple database types","Configuration persistence for Lakebase integration"]}
{"type":"entity","name":"GroupsSeed","entityType":"data_seed","observations":["Group initialization data in src/backend/src/seeds/groups.py","Default group configurations","Simplified group structure for 3-tier roles","Bootstrap data for multi-tenant setup"]}
{"type":"entity","name":"DatabaseMigrations","entityType":"migration_system","observations":["Three major migrations completed","1041071e3641: Dropped email_domain column from groups","6d23ffae21aa: Removed complex RBAC tables (privileges, roles, etc.)","update_user_roles_to_3tier: Migrated to simplified 3-tier role system","Located in src/backend/migrations/versions/"]}
{"type":"entity","name":"ToolBestPractices","entityType":"configuration","observations":["Best practices configuration in JSON format","Located at src/backend/src/seeds/tool_best_practices.json","Guidance for AI tool usage and security","Educational content for tool configuration"]}
{"type":"entity","name":"BackupRBACTests","entityType":"test_archive","observations":["Archived tests from complex RBAC system","Located in src/backend/tests/backup_rbac_tests/","Preserved for reference during migration","Tests for roles, privileges, identity providers"]}
{"type":"entity","name":"PermissionTestRequirements","entityType":"test_documentation","observations":["Permission system testing requirements","Located at src/backend/tests/unit/PERMISSION_TEST_REQUIREMENTS.md","Test specifications for new 3-tier system","Testing guidelines for role-based access"]}
{"type":"entity","name":"FirstAdminSetupTest","entityType":"test_component","observations":["Test for initial admin user setup","Located at src/backend/tests/unit/services/test_first_admin_setup.py","Validates initial system configuration","Bootstrap testing for user management"]}
{"type":"entity","name":"BaseRepository","entityType":"base_class","observations":["Core base class for all repositories","Located in src/backend/src/core/base_repository.py","Provides common CRUD operations","Async database operations using SQLAlchemy","Constructor takes model_class and session parameters","Extended by all repository implementations","Implements Unit of Work pattern through SQLAlchemy sessions","All operations handle transaction lifecycle","Automatic rollback on exceptions","Commit after flush to ensure persistence","Support for both int and UUID primary keys","Generic type support with ModelType bound to Base"]}
{"type":"entity","name":"BaseService","entityType":"base_class","observations":["Core base class for all services","Located in src/backend/src/core/base_service.py","Business logic orchestration layer","Uses repositories for data access","Async operations throughout","Constructor takes session as primary parameter","Uses repositories for all data access","Session dependency injected from FastAPI","Business logic orchestration without direct database access","Generic typing with ModelType and SchemaType","Standard CRUD operations delegated to repositories"]}
{"type":"entity","name":"HealthcheckRouter","entityType":"api_router","observations":["Health check endpoint for system monitoring","Located in src/backend/src/api/healthcheck_router.py","Provides system status and health metrics","Basic endpoint for load balancer health checks"]}
{"type":"entity","name":"LogsRouter","entityType":"api_router","observations":["Execution logs API endpoints","Located in src/backend/src/api/logs_router.py","Provides access to system and execution logs","Debugging and monitoring interface"]}
{"type":"entity","name":"FlowExecutionRouter","entityType":"api_router","observations":["Flow execution management API","Located in src/backend/src/api/flow_execution_router.py","Flow execution lifecycle management","Execution monitoring and control"]}
{"type":"entity","name":"TaskTrackingRouter","entityType":"api_router","observations":["Task execution tracking API","Located in src/backend/src/api/task_tracking_router.py","Task progress monitoring","Task status and timeline tracking"]}
{"type":"entity","name":"GenieRouter","entityType":"api_router","observations":["Databricks Genie integration API","Located in src/backend/src/api/genie_router.py","Genie space management and queries","Natural language to SQL interface"]}
{"type":"entity","name":"MCPRouter","entityType":"api_router","observations":["Model Context Protocol (MCP) integration API","Located in src/backend/src/api/mcp_router.py","MCP server management and configuration","External tool integration via MCP"]}
{"type":"entity","name":"ExecutionHistoryRouter","entityType":"api_router","observations":["Execution history API endpoints","Located in src/backend/src/api/execution_history_router.py","Historical execution records and analytics","Execution performance and trend analysis"]}
{"type":"entity","name":"TemplateGenerationRouter","entityType":"api_router","observations":["AI-powered template generation API","Located in src/backend/src/api/template_generation_router.py","Automated workflow template creation","LLM-driven template suggestions"]}
{"type":"entity","name":"AgentGenerationRouter","entityType":"api_router","observations":["AI-powered agent generation API","Located in src/backend/src/api/agent_generation_router.py","Automated agent creation and configuration","LLM-driven agent recommendations"]}
{"type":"entity","name":"CrewGenerationRouter","entityType":"api_router","observations":["AI-powered crew generation API","Located in src/backend/src/api/crew_generation_router.py","Automated crew composition and optimization","Multi-agent workflow generation"]}
{"type":"entity","name":"TaskGenerationRouter","entityType":"api_router","observations":["AI-powered task generation API","Located in src/backend/src/api/task_generation_router.py","Automated task creation and breakdown","Task optimization and suggestions"]}
{"type":"entity","name":"DatabaseManagementRouter","entityType":"api_router","observations":["Database management and migration API","Located in src/backend/src/api/database_management_router.py","Database backup, restore, and migration","Lakebase integration and setup"]}
{"type":"entity","name":"ConnectionsRouter","entityType":"api_router","observations":["External service connections API","Located in src/backend/src/api/connections_router.py","Third-party service integration management","Connection testing and validation"]}
{"type":"entity","name":"CrewService","entityType":"service","observations":["Crew management service layer","Located in src/backend/src/services/crew_service.py","Crew CRUD operations and orchestration","Business logic for crew workflows"]}
{"type":"entity","name":"GenieService","entityType":"service","observations":["Databricks Genie integration service","Located in src/backend/src/services/genie_service.py","Natural language to SQL processing","Genie space management and queries"]}
{"type":"entity","name":"DatabricksIndexService","entityType":"service","observations":["Databricks Vector Search index management","Located in src/backend/src/services/databricks_index_service.py","Index creation and configuration","Vector search operations"]}
{"type":"entity","name":"ExecutionCleanupService","entityType":"service","observations":["Execution cleanup and maintenance service","Located in src/backend/src/services/execution_cleanup_service.py","Cleanup of completed executions","Resource cleanup and optimization"]}
{"type":"entity","name":"ExecutionStatusService","entityType":"service","observations":["Execution status tracking service","Located in src/backend/src/services/execution_status_service.py","Status monitoring and updates","Execution state management"]}
{"type":"entity","name":"DatabricksVectorSearchVerificationService","entityType":"service","observations":["Vector Search setup verification","Located in src/backend/src/services/databricks_vectorsearch_verification_service.py","Index validation and health checks","Vector Search configuration verification"]}
{"type":"entity","name":"DatabricksVectorSearchSetupService","entityType":"service","observations":["Vector Search setup and configuration","Located in src/backend/src/services/databricks_vectorsearch_setup_service.py","Automated index creation","Vector Search environment setup"]}
{"type":"entity","name":"ExecutionTraceService","entityType":"service","observations":["Execution trace and debugging service","Located in src/backend/src/services/execution_trace_service.py","Execution step tracking","Debug information collection"]}
{"type":"entity","name":"TaskTrackingService","entityType":"service","observations":["Task execution tracking service","Located in src/backend/src/services/task_tracking_service.py","Task progress monitoring","Task performance analytics"]}
{"type":"entity","name":"DispatcherService","entityType":"service","observations":["Execution dispatcher and routing","Located in src/backend/src/services/dispatcher_service.py","Execution request routing","Load balancing and optimization"]}
{"type":"entity","name":"MCPRepository","entityType":"repository","observations":["Model Context Protocol data layer","Located in src/backend/src/repositories/mcp_repository.py","MCP server configuration storage","External tool integration settings"]}
{"type":"entity","name":"LLMManager","entityType":"service","observations":["Centralized LLM provider management","Located in src/backend/src/core/llm_manager.py","Supports multiple providers: Databricks, OpenAI, Anthropic","Configuration-driven model selection","Integration with CrewAI LLM abstraction"]}
{"type":"entity","name":"Logger","entityType":"utility","observations":["Application logging system","Located in src/backend/src/core/logger.py","Centralized logging configuration","Async-safe logging implementation"]}
{"type":"entity","name":"EntityExtractionFallback","entityType":"utility","observations":["Entity extraction fallback logic","Located in src/backend/src/core/entity_extraction_fallback.py","Backup entity parsing mechanisms","Error recovery for entity processing"]}
{"type":"entity","name":"UnitOfWork","entityType":"pattern","observations":["Unit of Work pattern implementation","Located in src/backend/src/core/unit_of_work.py","Transaction management for database operations","Multi-repository coordination"]}
{"type":"entity","name":"DatabricksConfigValidation","entityType":"validation","observations":["Validation error: secret_scope required when enabled=true and apps_enabled=false","Error occurs in DatabricksConfigCreate.validate_required_fields()","Required fields: warehouse_id, catalog, db_schema, secret_scope","Successfully removed secret_scope requirement","Updated schema validation to only require: warehouse_id, catalog, db_schema","Created migration 3e393f55f1eb to remove secret_scope column","All tests now pass without secret_scope field"]}
{"type":"entity","name":"permissions.py","entityType":"module","observations":["Core permission checking module at /src/backend/src/core/permissions.py","Contains is_workspace_admin() helper function","Implements require_roles() decorator for API endpoints","Handles permission resolution logic","Checks both user properties and workspace roles","Updated to support new two-tier permission model"]}
{"type":"entity","name":"User","entityType":"model","observations":["SQLAlchemy model for users","Needs is_system_admin boolean field","Needs is_personal_workspace_manager boolean field","Located in /src/backend/src/models/user.py","Stores user-level permissions","Auto-created on first authentication"]}
{"type":"entity","name":"databricks_router","entityType":"api_router","observations":["Updated to use workspace admin permissions","Configuration endpoints require is_workspace_admin()","Located at /src/backend/src/api/databricks_router.py","Handles Databricks integration configuration","Workspace-scoped configuration only","No longer uses simple role checks"]}
{"type":"entity","name":"memory_backend_router","entityType":"api_router","observations":["Updated to use workspace admin permissions","Create/update/delete require is_workspace_admin()","Located at /src/backend/src/api/memory_backend_router.py","Handles memory backend configuration","Workspace-scoped configuration only","Read endpoints accessible to all roles"]}
{"type":"entity","name":"DocumentationEmbeddingService","entityType":"service","observations":["Handles documentation embedding creation and search","Fixed MemoryBackendRepository instantiation - removed incorrect model class argument","Added logic to detect local development mode (SQLite or localhost PostgreSQL)","Skip database storage when Databricks/Lakebase is configured","Only store embeddings in database during local development","Return placeholder objects when skipping database storage","Located in src/backend/src/services/documentation_embedding_service.py"]}
{"type":"relation","from":"Backend","to":"ProcessCrewExecutor","relationType":"contains"}
{"type":"relation","from":"Backend","to":"CrewAIEngineService","relationType":"contains"}
{"type":"relation","from":"Backend","to":"TemplateService","relationType":"contains"}
{"type":"relation","from":"Backend","to":"DatabricksKnowledgeService","relationType":"contains"}
{"type":"relation","from":"ProcessCrewExecutor","to":"CrewAIEngineService","relationType":"uses"}
{"type":"relation","from":"CrewAIEngineService","to":"CrewPreparation","relationType":"uses"}
{"type":"relation","from":"CrewPreparation","to":"AgentHelpers","relationType":"uses"}
{"type":"relation","from":"UserRepository","to":"UserModel","relationType":"manages"}
{"type":"relation","from":"CrewRepository","to":"CrewModel","relationType":"manages"}
{"type":"relation","from":"AgentRepository","to":"AgentModel","relationType":"manages"}
{"type":"relation","from":"ProcessRepository","to":"ProcessModel","relationType":"manages"}
{"type":"relation","from":"KnowledgeRepository","to":"KnowledgeSourceModel","relationType":"manages"}
{"type":"relation","from":"TemplateRepository","to":"TemplateModel","relationType":"manages"}
{"type":"relation","from":"FlowRepository_Real","to":"FlowModel","relationType":"manages"}
{"type":"relation","from":"FlowExecutionRepository_Real","to":"FlowExecutionModel","relationType":"manages"}
{"type":"relation","from":"TaskRepository_Real","to":"TaskModel","relationType":"manages"}
{"type":"relation","from":"CrewRepository_Real","to":"CrewModel_Real","relationType":"manages"}
{"type":"relation","from":"AgentRepository_Real","to":"AgentModel_Real","relationType":"manages"}
{"type":"relation","from":"ToolRepository_Real","to":"ToolModel","relationType":"manages"}
{"type":"relation","from":"TemplateRepository_Real","to":"TemplateModel_Real","relationType":"manages"}
{"type":"relation","from":"UserRepository_Real","to":"UserModel_Real","relationType":"manages"}
{"type":"relation","from":"ExecutionRepository","to":"ExecutionStatusModel","relationType":"manages"}
{"type":"relation","from":"ExecutionLogsRepository","to":"ExecutionLogsModel","relationType":"manages"}
{"type":"relation","from":"ExecutionTraceRepository","to":"ExecutionTraceModel","relationType":"manages"}
{"type":"relation","from":"ExecutionHistoryRepository","to":"ExecutionHistoryModel","relationType":"manages"}
{"type":"relation","from":"GroupRepository","to":"GroupModel","relationType":"manages"}
{"type":"relation","from":"BillingRepository","to":"BillingModel","relationType":"manages"}
{"type":"relation","from":"LogRepository","to":"LogModel","relationType":"manages"}
{"type":"relation","from":"ChatHistoryRepository","to":"ChatHistoryModel","relationType":"manages"}
{"type":"relation","from":"ModelConfigRepository","to":"ModelConfigModel","relationType":"manages"}
{"type":"relation","from":"EngineConfigRepository","to":"EngineConfigModel","relationType":"manages"}
{"type":"relation","from":"DatabricksConfigRepository","to":"DatabricksConfigModel","relationType":"manages"}
{"type":"relation","from":"ApiKeyRepository","to":"ApiKeyModel","relationType":"manages"}
{"type":"relation","from":"ScheduleRepository","to":"ScheduleModel","relationType":"manages"}
{"type":"relation","from":"DataProcessingRepository","to":"DataProcessingModel","relationType":"manages"}
{"type":"relation","from":"DocumentationEmbeddingRepository","to":"DocumentationEmbeddingModel","relationType":"manages"}
{"type":"relation","from":"MemoryBackendRepository","to":"MemoryBackendModel","relationType":"manages"}
{"type":"relation","from":"McpRepository","to":"McpSettingsModel","relationType":"manages"}
{"type":"relation","from":"McpRepository","to":"McpServerModel","relationType":"manages"}
{"type":"relation","from":"SchemaRepository","to":"SchemaModel","relationType":"manages"}
{"type":"relation","from":"FlowModel","to":"TaskModel","relationType":"contains"}
{"type":"relation","from":"FlowModel","to":"AgentModel_Real","relationType":"uses"}
{"type":"relation","from":"FlowExecutionModel","to":"FlowModel","relationType":"executes"}
{"type":"relation","from":"TaskModel","to":"AgentModel_Real","relationType":"assigned_to"}
{"type":"relation","from":"TaskModel","to":"ToolModel","relationType":"uses"}
{"type":"relation","from":"CrewModel_Real","to":"AgentModel_Real","relationType":"contains"}
{"type":"relation","from":"AgentModel_Real","to":"ToolModel","relationType":"uses"}
{"type":"relation","from":"UserModel_Real","to":"GroupModel","relationType":"belongs_to"}
{"type":"relation","from":"ExecutionLogsModel","to":"FlowExecutionModel","relationType":"logs_for"}
{"type":"relation","from":"DatabricksVectorSearchEndpoint","to":"DatabricksVectorIndex","relationType":"manages"}
{"type":"relation","from":"DatabricksVectorSearchClient","to":"DatabricksVectorSearchEndpoint","relationType":"connects_to"}
{"type":"relation","from":"VectorEmbeddingPipeline","to":"DatabricksVectorIndex","relationType":"populates"}
{"type":"relation","from":"DatabricksVolumeManager","to":"DatabricksVolumeStorage","relationType":"coordinates"}
{"type":"relation","from":"VolumeKnowledgeIngestion","to":"DatabricksVolumeStorage","relationType":"reads_from"}
{"type":"relation","from":"VolumeKnowledgeIngestion","to":"VectorEmbeddingPipeline","relationType":"feeds_to"}
{"type":"relation","from":"DatabricksOBOAuthentication","to":"OBOTokenManager","relationType":"uses"}
{"type":"relation","from":"DatabricksOBOAuthentication","to":"UserContextManager","relationType":"uses"}
{"type":"relation","from":"DatabricksOAuthProvider","to":"OAuth2AuthorizationFlow","relationType":"implements"}
{"type":"relation","from":"AuthenticationFlowOrchestrator","to":"JWTAuthenticationFlow","relationType":"orchestrates"}
{"type":"relation","from":"AuthenticationFlowOrchestrator","to":"OAuth2AuthorizationFlow","relationType":"orchestrates"}
{"type":"relation","from":"AuthorizationManager","to":"UserContextManager","relationType":"validates_with"}
{"type":"relation","from":"DatabricksKnowledgeRouter","to":"DatabricksKnowledgeService","relationType":"delegates_to"}
{"type":"relation","from":"FlowsRouter","to":"FlowService","relationType":"delegates_to"}
{"type":"relation","from":"ExecutionsRouter","to":"ExecutionService","relationType":"delegates_to"}
{"type":"relation","from":"ModelsRouter","to":"ModelConfigService","relationType":"delegates_to"}
{"type":"relation","from":"DatabricksRouter","to":"DatabricksService","relationType":"delegates_to"}
{"type":"relation","from":"AgentRouter","to":"AgentService","relationType":"delegates_to"}
{"type":"relation","from":"TemplateRouter","to":"TemplateService","relationType":"delegates_to"}
{"type":"relation","from":"FlowService","to":"FlowRepository_Real","relationType":"uses"}
{"type":"relation","from":"ExecutionService","to":"ExecutionRepository","relationType":"uses"}
{"type":"relation","from":"ModelConfigService","to":"ModelConfigRepository","relationType":"uses"}
{"type":"relation","from":"DatabricksService","to":"DatabricksConfigRepository","relationType":"uses"}
{"type":"relation","from":"AgentService","to":"AgentRepository_Real","relationType":"uses"}
{"type":"relation","from":"TemplateService","to":"TemplateRepository_Real","relationType":"uses"}
{"type":"relation","from":"TaskService","to":"TaskRepository_Real","relationType":"uses"}
{"type":"relation","from":"ToolService","to":"ToolRepository_Real","relationType":"uses"}
{"type":"relation","from":"UserService","to":"UserRepository_Real","relationType":"uses"}
{"type":"relation","from":"DatabricksKnowledgeService","to":"DatabricksVectorIndexRepository","relationType":"uses"}
{"type":"relation","from":"DatabricksKnowledgeService","to":"DatabricksVolumeRepository","relationType":"uses"}
{"type":"relation","from":"CrewRouter","to":"CrewService","relationType":"delegates_to"}
{"type":"relation","from":"CrewService","to":"CrewRepository_Real","relationType":"uses"}
{"type":"relation","from":"AuthRouter","to":"AuthService","relationType":"delegates_to"}
{"type":"relation","from":"AgentsRouter","to":"AgentService","relationType":"delegates_to"}
{"type":"relation","from":"TemplatesRouter","to":"TemplateService","relationType":"delegates_to"}
{"type":"relation","from":"CrewsRouter","to":"CrewService","relationType":"delegates_to"}
{"type":"relation","from":"DuplicateDocumentIndexingIssue","to":"DatabricksKnowledgeService","relationType":"occurs_in"}
{"type":"relation","from":"AgentMemoryRequirement","to":"DatabricksVectorStorage","relationType":"enables_access_to"}
{"type":"relation","from":"DatabricksVectorStorage","to":"ShortTermMemory","relationType":"implements"}
{"type":"relation","from":"DatabricksVectorStorage","to":"LongTermMemory","relationType":"implements"}
{"type":"relation","from":"DatabricksVectorStorage","to":"EntityMemory","relationType":"implements"}
{"type":"relation","from":"DatabricksVectorStorage","to":"DocumentMemory","relationType":"implements"}
{"type":"relation","from":"CrewAIDatabricksWrapper","to":"DatabricksVectorStorage","relationType":"wraps"}
{"type":"relation","from":"ShortTermMemory","to":"DatabricksIndexSchemas","relationType":"uses_schema"}
{"type":"relation","from":"LongTermMemory","to":"DatabricksIndexSchemas","relationType":"uses_schema"}
{"type":"relation","from":"EntityMemory","to":"DatabricksIndexSchemas","relationType":"uses_schema"}
{"type":"relation","from":"DocumentMemory","to":"DatabricksIndexSchemas","relationType":"uses_schema"}
{"type":"relation","from":"MemoryBackendFactory","to":"ShortTermMemory","relationType":"creates"}
{"type":"relation","from":"MemoryBackendFactory","to":"LongTermMemory","relationType":"creates"}
{"type":"relation","from":"MemoryBackendFactory","to":"EntityMemory","relationType":"creates"}
{"type":"relation","from":"EntityMemory","to":"EntityRelationshipRetriever","relationType":"uses"}
{"type":"relation","from":"LongTermMemory","to":"TaskModel","relationType":"stores_descriptions_of"}
{"type":"relation","from":"MCPIntegration","to":"MCPAdapter","relationType":"uses"}
{"type":"relation","from":"MCPIntegration","to":"mcp_handler","relationType":"depends_on"}
{"type":"relation","from":"MCPIntegration","to":"MCPService","relationType":"integrates_with"}
{"type":"relation","from":"mcp_handler","to":"MCPAdapter","relationType":"manages"}
{"type":"relation","from":"CrewPreparation","to":"MCPIntegration","relationType":"uses"}
{"type":"relation","from":"agent_helpers","to":"MCPIntegration","relationType":"uses"}
{"type":"relation","from":"task_helpers","to":"MCPIntegration","relationType":"uses"}
{"type":"relation","from":"MCPAdapter","to":"CrewAI","relationType":"integrates_with"}
{"type":"relation","from":"MCPIntegration","to":"CrewAI","relationType":"extends"}
{"type":"relation","from":"mcp_handler","to":"CrewAI","relationType":"wraps_tools_for"}
{"type":"relation","from":"MemoryIndexConfiguration","to":"ShortTermMemory","relationType":"configures"}
{"type":"relation","from":"MemoryIndexConfiguration","to":"LongTermMemory","relationType":"configures"}
{"type":"relation","from":"MemoryIndexConfiguration","to":"EntityMemory","relationType":"configures"}
{"type":"relation","from":"MemoryIndexConfiguration","to":"DocumentMemory","relationType":"configures"}
{"type":"relation","from":"IndexSchemaStructure","to":"DatabricksIndexSchemas","relationType":"defines"}
{"type":"relation","from":"MemoryIndexConfiguration","to":"DatabricksVectorIndexRepository","relationType":"used_by"}
{"type":"relation","from":"DatabricksMemoryConfig","to":"MemoryIndexConfiguration","relationType":"stores"}
{"type":"relation","from":"ToolFactory","to":"ToolService","relationType":"depends_on"}
{"type":"relation","from":"ToolFactory","to":"ApiKeysService","relationType":"uses"}
{"type":"relation","from":"ToolFactory","to":"PerplexityTool","relationType":"creates"}
{"type":"relation","from":"ToolFactory","to":"GenieTool","relationType":"creates"}
{"type":"relation","from":"ToolFactory","to":"DatabricksCustomTool","relationType":"creates"}
{"type":"relation","from":"ToolFactory","to":"DatabricksJobsTool","relationType":"creates"}
{"type":"relation","from":"ToolFactory","to":"PythonPPTXTool","relationType":"creates"}
{"type":"relation","from":"CrewPreparation","to":"ToolFactory","relationType":"uses"}
{"type":"relation","from":"agent_helpers","to":"ToolFactory","relationType":"uses"}
{"type":"relation","from":"task_helpers","to":"ToolFactory","relationType":"uses"}
{"type":"relation","from":"ToolFactory","to":"CrewAI","relationType":"provides_tools_for"}
{"type":"relation","from":"GenieTool","to":"DatabricksService","relationType":"retrieves_config_from"}
{"type":"relation","from":"DatabricksCustomTool","to":"DatabricksService","relationType":"retrieves_config_from"}
{"type":"relation","from":"DatabricksJobsTool","to":"DatabricksService","relationType":"retrieves_config_from"}
{"type":"relation","from":"ToolService","to":"ToolRepository","relationType":"uses"}
{"type":"relation","from":"ToolFactory","to":"UnitOfWork","relationType":"uses"}
{"type":"relation","from":"ApiKeysService","to":"EncryptionUtils","relationType":"uses"}
{"type":"relation","from":"PerplexityTool","to":"ApiKeysService","relationType":"retrieves_key_from"}
{"type":"relation","from":"GenieTool","to":"UserContext","relationType":"retrieves_token_from"}
{"type":"relation","from":"DatabricksCustomTool","to":"UserContext","relationType":"retrieves_token_from"}
{"type":"relation","from":"DatabricksJobsTool","to":"UserContext","relationType":"retrieves_token_from"}
{"type":"relation","from":"TaskGenerationService","to":"DocumentationEmbeddingService","relationType":"uses"}
{"type":"relation","from":"TaskGenerationService","to":"ToolBestPracticesJSON","relationType":"leverages"}
{"type":"relation","from":"AgentGenerationService","to":"DocumentationEmbeddingService","relationType":"uses"}
{"type":"relation","from":"AgentGenerationService","to":"ToolBestPracticesJSON","relationType":"leverages"}
{"type":"relation","from":"CrewGenerationService","to":"DocumentationEmbeddingService","relationType":"uses"}
{"type":"relation","from":"DocumentationSeeder","to":"ToolBestPracticesJSON","relationType":"loads"}
{"type":"relation","from":"LakebaseService","to":"DatabaseConfigRepository","relationType":"uses"}
{"type":"relation","from":"LakebaseService","to":"ApiKeysService","relationType":"depends_on"}
{"type":"relation","from":"DatabaseConfigRepository","to":"LakebaseConfig","relationType":"manages"}
{"type":"relation","from":"PermissionSystem","to":"GroupContext","relationType":"uses"}
{"type":"relation","from":"GroupContext","to":"GroupService","relationType":"retrieves_roles_from"}
{"type":"relation","from":"DatabaseRouter","to":"LakebaseSession","relationType":"routes_to"}
{"type":"relation","from":"DatabricksKnowledgeSearchTool","to":"DatabricksKnowledgeService","relationType":"calls"}
{"type":"relation","from":"PermissionsCore","to":"ThreeTierRoleModel","relationType":"implements"}
{"type":"relation","from":"permissions.py","to":"SecurityModel","relationType":"implements"}
{"type":"relation","from":"User","to":"SystemAdmin","relationType":"stores"}
{"type":"relation","from":"User","to":"PersonalWorkspaceManager","relationType":"stores"}
{"type":"relation","from":"permissions.py","to":"PermissionResolution","relationType":"implements"}
{"type":"relation","from":"databricks_router","to":"permissions.py","relationType":"uses"}
{"type":"relation","from":"memory_backend_router","to":"permissions.py","relationType":"uses"}
{"type":"relation","from":"GroupContext","to":"WorkspaceIsolation","relationType":"enforces"}
{"type":"relation","from":"GroupContext","to":"permissions.py","relationType":"used_by"}