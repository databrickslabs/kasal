"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[531],{2531:(e,o,t)=>{t.d(o,{ConnectionService:()=>i});var n=t(7887),r=t(3062),s=t(9478);class i{static formatTasks(e){console.log("=== Formatting Tasks ==="),console.log("Tasks before formatting:",JSON.stringify(e,null,2));const o=e.map((e=>{var o,t,n,r,s;const i={name:e.name,description:e.description||e.name,expected_output:e.expected_output||"",agent_id:e.agent_id,async_execution:e.async_execution,human_input:e.human_input||!1,tools:e.tools||[],markdown:e.markdown||!1,context:{type:(null===(o=e.context)||void 0===o?void 0:o.type)||"general",priority:(null===(t=e.context)||void 0===t?void 0:t.priority)||"medium",complexity:(null===(n=e.context)||void 0===n?void 0:n.complexity)||"medium",required_skills:(null===(r=e.context)||void 0===r?void 0:r.required_skills)||[],metadata:(null===(s=e.context)||void 0===s?void 0:s.metadata)||{}}};return e.type&&(i.context.type=e.type),e.priority&&(i.context.priority=e.priority),e.complexity&&(i.context.complexity=e.complexity),e.required_skills&&(i.context.required_skills=e.required_skills),i}));return console.log("Tasks after formatting:",JSON.stringify(o,null,2)),o}static validateData(e,o){console.log("=== Validating Input Data ==="),console.log("Raw tasks received:",JSON.stringify(o,null,2)),e.forEach(((e,o)=>{if(!e.name)throw new Error("Agent ".concat(o+1," missing required field: name"));if(!e.role)throw new Error("Agent ".concat(o+1," missing required field: role"));if(!e.goal)throw new Error("Agent ".concat(o+1," missing required field: goal"))})),o.forEach(((e,o)=>{if(console.log("Validating task ".concat(o+1,":"),e),!e.name)throw console.error("Task ".concat(o+1," missing name. Full task object:"),e),new Error("Task ".concat(o+1," missing required field: name"));if(!e.description)throw console.error("Task ".concat(o+1," missing description. Full task object:"),e),new Error("Task ".concat(o+1," missing required field: description"))}))}static async formatModel(e){const o=e.trim().toLowerCase();let t;try{t=await this.modelService.getActiveModels()}catch(s){console.error("Error fetching models from ModelService:",s),t=this.modelService.getActiveModelsSync()}var n;if(console.log("=== Model Validation ==="),console.log("Available models:",Object.keys(t)),console.log("Requested model:",o),!Object.keys(t).includes(o))return console.warn('Invalid model "'.concat(e,'" provided, using default model "').concat(this.DEFAULT_MODEL,'"')),(null===(n=t[this.DEFAULT_MODEL])||void 0===n?void 0:n.name)||this.DEFAULT_MODEL;const r=t[o];return console.log("Model validated successfully:",o),console.log("Using model configuration:",r),r.name}static async generateConnections(e,o,t){console.log("=== Starting Connection Generation ==="),console.log("Input parameters:",{agentsCount:e.length,tasksCount:o.length,model:t,fullTasks:o});try{this.validateData(e,o);const r=this.formatTasks(o),s=await this.formatModel(t),i={agents:e.map((e=>({name:e.name,role:e.role,goal:e.goal,backstory:e.backstory||"Not provided",tools:e.tools||[]}))),tasks:r,model:s};console.log("=== Making API Request ==="),console.log("Full Request Data:",JSON.stringify(i,null,2));const a=await n.Ay.post("/connections/generate-connections",i,{headers:{"Content-Type":"application/json"},timeout:3e4});return console.log("=== API Response ==="),console.log("Response status:",a.status),console.log("Response data:",JSON.stringify(a.data,null,2)),a.data}catch(w){if(console.log("=== Connection Generation Error ==="),console.error("Full error details:",{error:w,tasks:o,agents:e,model:t}),w instanceof r.pe){var s,i,a,l,c,d,u,g,m;const e={message:w.message,status:null===(s=w.response)||void 0===s?void 0:s.status,statusText:null===(i=w.response)||void 0===i?void 0:i.statusText,responseData:null===(a=w.response)||void 0===a?void 0:a.data,requestData:null!==(l=w.config)&&void 0!==l&&l.data?JSON.parse(w.config.data):null,originalTasks:o};var v,p;if(console.error("Detailed Error Information:",e),422===(null===(c=w.response)||void 0===c?void 0:c.status))throw new Error("Validation error: ".concat((null===(v=w.response.data)||void 0===v?void 0:v.detail)||"Invalid request data"));if(400===(null===(d=w.response)||void 0===d?void 0:d.status))throw new Error("Bad request: ".concat((null===(p=w.response.data)||void 0===p?void 0:p.detail)||"Invalid request format"));if(500===(null===(u=w.response)||void 0===u?void 0:u.status)){var f,k,y;console.error("Server error details:",null===(f=w.response)||void 0===f?void 0:f.data);const e=(null===(k=w.response)||void 0===k||null===(y=k.data)||void 0===y?void 0:y.detail)||"Unknown server error";throw new Error("Server error (500): ".concat(e))}throw new Error("Failed to generate connections: ".concat((null===(g=w.response)||void 0===g||null===(m=g.data)||void 0===m?void 0:m.detail)||w.message))}throw new Error("Unexpected error during connection generation: ".concat(w instanceof Error?w.message:"Unknown error"))}}}i.DEFAULT_MODEL="gpt-4",i.modelService=s.J.getInstance()}}]);